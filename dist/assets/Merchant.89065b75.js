import{r as c,u as K,s as Q,i as W,k as T,b as t,_ as X,j as u,$ as Y,B as U,S as Z,F as ee,O as te,T as ae,aD as ie}from"./index.5670e6e0.js";import{F as i}from"./index.11c9b67d.js";import{I as f}from"./index.66fe089c.js";import{P as ne}from"./index.77a6b2f7.js";import{p as le}from"./pickBy.15fa557e.js";import{D as se}from"./dropdown.706ec38f.js";import{H as oe}from"./index.04556cd2.js";import{s as o}from"./index.module.f94ed99e.js";import{S as re}from"./index.73a4613c.js";import{E as v}from"./index.1c39e7a0.js";import{U as ce}from"./upload.3b886abe.js";import{u as ue}from"./index.5733fb44.js";import{I as me}from"./information.c9048f81.js";import{T as L}from"./TimePriceItem.1fe90ca6.js";import{P as R}from"./personal.dd90e075.js";/* empty css                    *//* empty css                 */import"./is-node-with-content.f661b98b.js";import"./interopRequireDefault.fc5525a1.js";import"./dev-log.6e115cc9.js";import"./index.31244c45.js";import"./index.cb878f88.js";import"./convert-px.daab3cc2.js";import"./CloseCircleFill.55d4b485.js";import"./bound.bddb6539.js";import"./index.c6660251.js";import"./use-gesture-react.esm.346ddc85.js";import"./rubberband.c88fa690.js";import"./PurePanel.2a417db7.js";import"./index.42a6e0fb.js";import"./index.92e459fd.js";import"./collapse.e34cf270.js";import"./useFlexGapSupport.172cfcf4.js";import"./last.7ecc4488.js";function Ke(){var O,P;const I=c.exports.useRef(null),[p]=i.useForm(),S=K(),{area:m}=Q.getState().global.areaRegion,k=W(),$=(O=k==null?void 0:k.state)==null?void 0:O.id,h=ue(document.querySelector("body")),[V,E]=c.exports.useState(!1),[_,g]=c.exports.useState([m[0].label]),[r,w]=c.exports.useState("$"),[l,A]=c.exports.useState({file_path:"",file_url:""}),[F,B]=c.exports.useState(),[N,D]=c.exports.useState(),[j,H]=c.exports.useState([]),{data:de,loading:M}=T(()=>me.getInformationList({type:9}),{onSuccess(e){H(e==null?void 0:e.data)}}),{data:s,run:pe}=T(()=>R.getChannelInfo({}),{onSuccess:e=>{var a,n,C;p.setFieldsValue({...e.data}),(a=e==null?void 0:e.data)!=null&&a.channel_area&&g([(n=m.find(y=>{var x;return y.label===((x=e==null?void 0:e.data)==null?void 0:x.channel_area)}))==null?void 0:n.label]),e.data.cost_type===1&&w("%"),e.data.cost_type===2&&(B(e.data.cost.eat_in),D(e.data.cost.take_out)),A({file_url:(C=e==null?void 0:e.data)==null?void 0:C.channel_head,file_path:""})}}),J=async()=>{await p.validateFields().then(async e=>{var y,x,q;_&&(e.channel_area=(y=m.find(d=>d.name===_[0]))==null?void 0:y.label),((l==null?void 0:l.file_path)||((x=s==null?void 0:s.data)==null?void 0:x.channel_head))&&(e.channel_head=(l==null?void 0:l.file_path)||((q=s==null?void 0:s.data)==null?void 0:q.channel_head));const a=[];if(F&&r==="$"){let d={};Object.keys(F).map(b=>{d={price:e.eat_in[`price_${b}`],time:e.eat_in[`time_${b}`][0]},a.push(d)})}const n=[];if(N&&r==="$"){let d={};Object.keys(N).map(b=>{d={price:e.take_out[`price_${b}`],time:e.take_out[`time_${b}`][0]},n.push(d)})}r==="$"?(e.cost_type=2,e.cost=JSON.stringify({eat_in:a,take_out:n}),delete e.eat_in,delete e.take_out):e.cost_type=1,e=le(e,ie),(await R.updateChannel({...e})).status===200&&S(-1)})},z=async e=>{const a=[...e.target.files];if(a.length){const n=await ce.uploadFile(a);(n==null?void 0:n.status)===200&&(ae.show(n.data.msg),A(n.data.data))}},G=e=>{e!=null&&e.key&&g([m.find(a=>Number(a.value)===Number(e==null?void 0:e.key)).label])};return M?t(X,{color:"primary"}):u("div",{className:`${o.AddEmployeeForm} pt-[48px] pb-[90px] bg-[#fff] sm:p-0 !sm:min-h-[calc(100vh-60px)] sm:flex sm:justify-center sm:items-center`,children:[t(oe,{renderRight:!1,title:"\u7F16\u8F91\u6E20\u9053\u8BE6\u7EC6\u8D44\u6599",border:!0}),t("div",{className:"flex flex-col px-5 py-12 sm:w-500px",children:u(i,{form:p,requiredMarkStyle:"none",layout:"horizontal",footer:null,children:[u("div",{className:"flex items-center",children:[t(Y,{name:(P=s==null?void 0:s.data)==null?void 0:P.name,headurl:l==null?void 0:l.file_url}),t(U,{loading:"auto",onClick:async()=>{await I.current.click()},className:"bg-[#f3f3f3] border-0 ml-4",shape:"rounded",loadingIcon:t(v,{}),children:"\u4E0A\u4F20\u5934\u50CF"}),t("input",{id:"file",type:"file",ref:I,accept:".jpg,.jpeg,.png",hidden:!0,onChange:e=>z(e)})]}),t("p",{className:"pt-12 pb-4",children:"\u57FA\u672C\u8D44\u6599"}),t(i.Item,{name:"channel_name",label:"\u6E20\u9053\u540D\u79F0",rules:[{required:!0}],children:t(f,{placeholder:"\u6E20\u9053\u540D\u79F0"})}),t(i.Item,{name:"channel_email",label:"\u6E20\u9053\u90AE\u7BB1",rules:[{required:!0}],children:t(f,{placeholder:"\u90AE\u7BB1"})}),t(i.Item,{label:"\u6E20\u9053\u624B\u673A",children:u("div",{className:o.phone,children:[u("div",{onClick:()=>{(h==null?void 0:h.width)&&(h==null?void 0:h.width)<=640&&E(!0)},className:`${o.phoneCode} text-xs h-full pl-3 pr-2 flex items-center justify-center`,children:[t("p",{className:"min-w-30px text-center sm:hidden",children:_}),t(se,{menu:{items:m,onClick:G},className:"<sm:hidden min-w-40px text-center",children:t("a",{onClick:e=>e.preventDefault(),children:_})}),t(Z,{name:"phone-bottom",className:"w-[5px] h-[3px]"})]}),t(ne,{columns:[m],visible:V,onClose:()=>{E(!1)},value:_,onConfirm:e=>{g([m.find(a=>a.value===e[0]).label])}}),t(i.Item,{noStyle:!0,name:"channel_phone",rules:[{required:!0}],children:t(f,{placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",className:o.input})})]})}),t(i.Item,{label:"\u6210\u672C",children:u("div",{className:"flex items-center",children:[u("div",{className:`${o.cost} flex items-center mr-2`,children:[t("span",{className:"text-xs pl-3 w-6 flex items-center justify-center",children:r}),r==="$"&&t(i.Item,{noStyle:!0,rules:[{required:!1}],children:t(f,{disabled:!0,placeholder:"0.00",className:`${o.input}`})}),r!=="$"&&t(i.Item,{noStyle:!0,name:"cost",rules:[{required:!0}],children:t(f,{placeholder:"0.00",className:`${o.input}`})})]}),t(re,{valueUnit:r,changeConfirm:e=>{w(e),p.setFieldsValue({cost:""})},leftUnit:"%",rightUnit:"$"})]})}),r==="$"&&u(ee,{children:[t(i.Item,{className:`${o.dineIn} mt-4`,name:"eat_in",label:"\u5802\u98DF",children:t(L,{form:p,isEdit:$,timePicker:j,list:F,setList:B,keyTitle:"eat_in"})}),t(i.Item,{className:`${o.takeOut}`,name:"take_out",label:"\u5916\u5356",children:t(L,{isEdit:$,timePicker:j,list:N,setList:D,keyTitle:"take_out",form:p})})]}),t(i.Item,{layout:"vertical",name:"address",label:"\u5730\u5740\uFF08\u9009\u586B\uFF09",children:t(f,{placeholder:"\u5DE5\u4F5C\u5730\u70B9"})}),t("div",{className:"<sm:fixed-b-btn flex sm:mt-4",children:t(U,{onClick:J,className:"w-[70%] h-[2.75rem] rounded-xl sm:w-full",block:!0,type:"submit",color:"primary",loading:"auto",loadingIcon:t(v,{}),children:"\u4FDD\u5B58"})})]})}),t("div",{onClick:()=>S(-1),className:"fixed top-80px right-40px <sm:hidden",children:t(te,{fontSize:24,className:"cursor-pointer"})})]})}export{Ke as default};
