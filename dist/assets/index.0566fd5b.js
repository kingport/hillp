import{u as R,r,s as y,a as T,b as i,F as J,j as c,$ as K,B as k,S as L,O as Q,T as f,de as W}from"./index.5670e6e0.js";import{F as l}from"./index.11c9b67d.js";import{I as _}from"./index.66fe089c.js";import{P as X}from"./index.77a6b2f7.js";import{D as Y}from"./dropdown.706ec38f.js";import{H as Z}from"./index.9fe94518.js";import{u as z}from"./index.5733fb44.js";import{E as I}from"./index.1c39e7a0.js";import{P as b}from"./personal.dd90e075.js";import{U as ee}from"./upload.3b886abe.js";/* empty css                    *//* empty css                 */import"./is-node-with-content.f661b98b.js";import"./interopRequireDefault.fc5525a1.js";import"./dev-log.6e115cc9.js";import"./index.31244c45.js";import"./index.cb878f88.js";import"./convert-px.daab3cc2.js";import"./CloseCircleFill.55d4b485.js";import"./bound.bddb6539.js";import"./index.c6660251.js";import"./use-gesture-react.esm.346ddc85.js";import"./rubberband.c88fa690.js";import"./PurePanel.2a417db7.js";import"./index.42a6e0fb.js";import"./index.92e459fd.js";import"./collapse.e34cf270.js";import"./useFlexGapSupport.172cfcf4.js";const te="_AddEmployeeForm_1tc8g_1",ie="_phone_1tc8g_57",oe="_input_1tc8g_64",ae="_phoneCode_1tc8g_69",ne="_cost_1tc8g_73",le="_dineIn_1tc8g_87",se="_price_1tc8g_104",re="_takeOut_1tc8g_122",ce="_footerGroup_1tc8g_157",C={AddEmployeeForm:te,"adm-list-item-disabled":"_adm-list-item-disabled_1tc8g_41",phone:ie,input:oe,phoneCode:ae,cost:ne,dineIn:le,price:se,takeOut:re,footerGroup:ce};function Ge(){const u=R(),m=z(document.querySelector("body")),F=r.exports.useRef(null),e=y.getState().global.userInfo,{area:s}=y.getState().global.areaRegion,[P,w]=r.exports.useState(!1),[d,x]=r.exports.useState([s[0].label]),[p]=l.useForm(),[v,V]=r.exports.useState(!1),[n,B]=r.exports.useState({file_path:"",file_url:""}),[A,j]=r.exports.useState(!1),U=t=>{j(t!==e.email)},[E,q]=r.exports.useState(!1),O=t=>{q(t!==e.phone)},G=async()=>{await p.validateFields().then(async t=>{var a;if(d&&(t.area=(a=s.find(h=>h.label===d[0]))==null?void 0:a.value),A&&!await S(2,t.email,t.email_code)||E&&!await S(1,t.phone,t.phone_code,t.area))return;((n==null?void 0:n.file_path)||(e==null?void 0:e.head))&&(t.head=(n==null?void 0:n.file_path)||e.head);const o=await b.editBaseUser({...t});o.status===200&&(f.show(o.msg),y.dispatch(W),u("/personal/information"))})},N=async(t,o,a="")=>{let h={source:1,type:t,username:o,area_code:a};const g=await b.getVerifyCode(h);g.status===200?f.show("\u53D1\u9001\u6210\u529F"):f.show(g.msg)},S=async(t,o,a,h="")=>{let g={source:1,type:t,username:o,code:a,area_code:h};const D=await b.checkVerifyCode(g);return D.status!==200?(f.show(D.msg),!1):!0};T(()=>{var t;p.setFieldsValue({nickname:e.nickname,email:e.email,phone:e.phone}),x([(t=s.find(o=>o.value===e.area_id*1))==null?void 0:t.label]),B({file_url:e.head})});const H=async t=>{const o=[...t.target.files];if(o.length){const a=await ee.uploadFile(o);(a==null?void 0:a.status)===200&&(f.show(a.data.msg),B(a.data.data))}},M=t=>{t!=null&&t.key&&x([s.find(o=>Number(o.value)===Number(t==null?void 0:t.key)).label])},$=()=>{(e==null?void 0:e.user_type)===2&&u("/personal/information/merchant/edit"),(e==null?void 0:e.user_type)===1&&u("/manage/employee/info/edit/detail",{state:{onlineUser:"onlineUser",nickname:e==null?void 0:e.nickname}})};return i(J,{children:c("div",{className:`${C.AddEmployeeForm} pt-[48px] pb-[90px] bg-[#fff]`,children:[c("div",{className:"flex flex-col px-10 py-12",children:[c(l,{form:p,requiredMarkStyle:"none",footer:null,children:[c("div",{className:"flex items-center",children:[i(K,{name:e==null?void 0:e.nickname,headurl:n==null?void 0:n.file_url}),i(k,{onClick:async()=>{await F.current.click()},className:"bg-[#f3f3f3] border-0 ml-4",shape:"rounded",children:"\u4E0A\u4F20\u5934\u50CF"}),i("input",{id:"file",type:"file",ref:F,accept:".jpg,.jpeg,.png",hidden:!0,onChange:t=>H(t)})]}),i(l.Item,{name:"nickname",label:(e==null?void 0:e.user_type)===1?"\u4E2A\u4EBA\u6635\u79F0*":"\u5546\u5BB6\u540D\u79F0* ",rules:[{required:!0}],children:i(_,{placeholder:"\u6635\u79F0"})}),i(l.Item,{name:"email",label:"\u90AE\u7BB1*",rules:[{required:!0}],children:i(_,{placeholder:"\u90AE\u7BB1",onChange:U})}),A&&i(l.Item,{name:"email_code",label:"\u90AE\u7BB1\u9A8C\u8BC1\u7801",rules:[{required:!0}],extra:i("a",{className:"relative top-20px text-xs",onClick:()=>{N(2,p.getFieldValue("email"))},children:"\u83B7\u53D6\u9A8C\u8BC1\u7801"}),children:i(_,{})}),i(l.Item,{label:"\u624B\u673A*",children:c("div",{className:C.phone,children:[c("div",{onClick:()=>{(m==null?void 0:m.width)&&(m==null?void 0:m.width)<=640&&w(!0)},className:`${C.phoneCode} text-xs h-full pl-3 pr-2 flex items-center justify-center`,children:[i("p",{className:"min-w-30px text-center sm:hidden",children:d}),i(Y,{menu:{items:s,onClick:M},className:"<sm:hidden min-w-40px text-center",children:i("a",{onClick:t=>t.preventDefault(),children:d})}),i(L,{name:"phone-bottom",className:"w-[5px] h-[3px]"})]}),i(X,{columns:[s],visible:P,onClose:()=>{w(!1)},value:d,onConfirm:t=>{x([s.find(o=>o.value===t[0]).label])}}),i(l.Item,{noStyle:!0,name:"phone",rules:[{required:!0}],children:i(_,{placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",className:C.input,onChange:O})})]})}),E&&i(l.Item,{name:"phone_code",label:"\u624B\u673A\u9A8C\u8BC1\u7801",rules:[{required:!0}],extra:i("a",{className:"relative top-20px text-xs",onClick:()=>{N(1,p.getFieldValue("phone"),d[0])},children:"\u83B7\u53D6\u9A8C\u8BC1\u7801"}),children:i(_,{})}),c("div",{className:"flex justify-center mt-8",children:[i(k,{onClick:$,className:"w-[30%] flex items-center justify-center mr-4 h-[2.75rem] rounded-xl border-0 bg-[#F3F3F3]",block:!0,children:"\u7F16\u8F91\u8BE6\u60C5\u8D44\u6599"}),i(k,{onClick:G,className:"w-[30%] h-[2.75rem] rounded-xl",block:!0,type:"submit",color:"primary",loading:"auto",loadingIcon:i(I,{}),children:"\u4FDD\u5B58"})]})]}),i(Z,{actions:[{text:"\u7F16\u8F91\u8BE6\u7EC6\u8D44\u6599",key:"editDetail",onClick:()=>{(e==null?void 0:e.user_type)===2&&u("/personal/information/merchant/edit"),(e==null?void 0:e.user_type)===1&&u("/manage/employee/info/edit/detail",{state:{onlineUser:"onlineUser",nickname:e==null?void 0:e.nickname}})}}],visible:v,setVisible:V})]}),i("div",{onClick:()=>u(-1),className:"fixed top-80px right-40px",children:i(Q,{fontSize:24,className:"cursor-pointer"})})]})})}export{Ge as default};
