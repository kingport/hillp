import{co as v,r as h,s as M,u as T,k as G,j as d,b as t,B as w,S as E,cp as V,O as $,T as S,aD as F}from"./index.5670e6e0.js";import{F as s}from"./index.11c9b67d.js";import{I as b}from"./index.66fe089c.js";import{P as z}from"./index.77a6b2f7.js";import{A as H}from"./index.ce6214e9.js";import{T as K}from"./index.21b1b6fd.js";import{p as g}from"./pickBy.15fa557e.js";import{D as U}from"./dropdown.706ec38f.js";import{H as J}from"./index.04556cd2.js";import{E as I}from"./index.1c39e7a0.js";import{U as Y}from"./upload.3b886abe.js";import{u as Q}from"./index.5733fb44.js";import{G as m,I as W}from"./init.01b19658.js";import{P as B}from"./personal.dd90e075.js";/* empty css                    *//* empty css                 */import"./is-node-with-content.f661b98b.js";import"./interopRequireDefault.fc5525a1.js";import"./dev-log.6e115cc9.js";import"./index.31244c45.js";import"./index.cb878f88.js";import"./convert-px.daab3cc2.js";import"./CloseCircleFill.55d4b485.js";import"./bound.bddb6539.js";import"./index.c6660251.js";import"./use-gesture-react.esm.346ddc85.js";import"./rubberband.c88fa690.js";import"./PurePanel.2a417db7.js";import"./index.42a6e0fb.js";import"./index.92e459fd.js";import"./collapse.e34cf270.js";import"./useFlexGapSupport.172cfcf4.js";const X="_channel_4i3uc_1",Z="_AddEmployeeForm_4i3uc_7",ee="_phone_4i3uc_46",te="_input_4i3uc_53",ne="_phoneCode_4i3uc_58",oe="_cost_4i3uc_61",ie="_dineIn_4i3uc_75",ae="_price_4i3uc_100",se="_takeOut_4i3uc_110",_={channel:X,AddEmployeeForm:Z,phone:ee,input:te,phoneCode:ne,cost:oe,dineIn:ie,price:ae,takeOut:se};m.setApiKey(v);m.setLanguage("en");m.setRegion("es");m.setLocationType("ROOFTOP");function Te(){const C=h.exports.useRef(null),[f]=s.useForm(),{area:l}=M.getState().global.areaRegion,x=T(),c=Q(document.querySelector("body")),[O,N]=h.exports.useState(!1),[p,y]=h.exports.useState([l[0].label]),[a,k]=h.exports.useState({file_path:"",file_url:""}),{data:u,refresh:A,run:P}=G(()=>B.onlineMerchant({}),{manual:!0,onSuccess:e=>{var n,o;f.setFieldsValue({...e.data}),y([(n=l.find(r=>{var i;return r.label===((i=e==null?void 0:e.data)==null?void 0:i.online_area)}))==null?void 0:n.name]),k({file_url:(o=e==null?void 0:e.data)==null?void 0:o.online_head,file_path:""})}});h.exports.useEffect(()=>{P()},[]);const D=async()=>{await f.validateFields().then(async e=>{var n,o,r;p&&(e.online_area=(n=l.find(i=>i.name===p[0]))==null?void 0:n.label),((a==null?void 0:a.file_path)||((o=u==null?void 0:u.data)==null?void 0:o.online_head))&&(e.online_head=(a==null?void 0:a.file_path)||((r=u==null?void 0:u.data)==null?void 0:r.online_head)),e=g(e,F),e.online_address?m.fromAddress(e.online_address).then(async i=>{const{lat:L,lng:q}=i.results[0].geometry.location;e.latitude=`${L},${q}`,e=g(e,F),(await B.updateOnlineMerchant({...e})).status===200&&(A(),x("/personal/auth/online"))},i=>{S.show(JSON.stringify(i))}):(e=g(e,F),(await B.updateOnlineMerchant({...e})).status===200&&(A(),x("/personal/auth/online")))})},j=async e=>{const n=[...e.target.files];if(n.length){const o=await Y.uploadFile(n);(o==null?void 0:o.status)===200&&(S.show(o.data.msg),k(o.data.data))}},R=e=>{e!=null&&e.key&&y([l.find(n=>Number(n.value)===Number(e==null?void 0:e.key)).label])};return d("div",{className:`${_.AddEmployeeForm} pt-[48px] pb-[90px] bg-[#fff] sm:pb-0 sm:pt-0 sm:flex sm:justify-center sm:min-h-none sm:items-center sm:h-[calc(100vh-60px)]`,children:[t(J,{renderRight:!1,title:"\u7F16\u8F91\u5546\u5BB6\u7EBF\u4E0A\u4FE1\u606F",border:!0}),t("div",{className:"flex flex-col px-10 py-12 sm:w-500px",children:d(s,{form:f,requiredMarkStyle:"none",layout:"horizontal",footer:null,children:[d("div",{className:"flex items-center",children:[t(H,{style:{"--border-radius":"50%","--size":"80px"},className:"mr-5",src:a==null?void 0:a.file_url}),t(w,{loading:"auto",onClick:async()=>{await C.current.click()},className:"bg-[#f3f3f3] border-0",shape:"rounded",loadingIcon:t(I,{}),children:"\u4E0A\u4F20\u5934\u50CF"}),t("input",{id:"file",type:"file",ref:C,accept:".jpg,.jpeg,.png",hidden:!0,onChange:e=>j(e)})]}),t("p",{className:"pt-12 pb-4",children:"\u57FA\u672C\u8D44\u6599"}),t(s.Item,{name:"online_name",label:"\u5546\u5BB6\u540D\u79F0",rules:[{required:!0}],children:t(b,{placeholder:"\u5546\u5BB6\u540D\u79F0"})}),t(s.Item,{name:"online_email",label:"\u5546\u5BB6\u90AE\u7BB1",rules:[{required:!0}],children:t(b,{placeholder:"\u5546\u5BB6\u90AE\u7BB1"})}),t(s.Item,{label:"\u5546\u5BB6\u624B\u673A",children:d("div",{className:_.phone,children:[d("div",{onClick:()=>{(c==null?void 0:c.width)&&(c==null?void 0:c.width)<=640&&N(!0)},className:`${_.phoneCode} text-xs h-full pl-3 pr-2 flex items-center justify-center`,children:[t("span",{className:"w-25px sm:hidden",children:p}),t(U,{menu:{items:l,onClick:R},className:"<sm:hidden min-w-40px text-center",children:t("a",{onClick:e=>e.preventDefault(),children:p})}),t(E,{name:"phone-bottom",className:"w-[5px] h-[3px] ml-2"})]}),t(z,{columns:[l],visible:O,onClose:()=>{N(!1)},value:p,onConfirm:e=>{y([l.find(n=>n.value===e[0]).label])}}),t(s.Item,{noStyle:!0,name:"online_phone",rules:[{required:!0}],children:t(b,{placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",className:_.input})})]})}),t(s.Item,{layout:"vertical",label:"\u5730\u5740\uFF08\u9009\u586B\uFF09",children:d("div",{className:"flex items-center justify-between",children:[t(s.Item,{noStyle:!0,name:"online_address",children:t(W,{})}),t(E,{onClick:()=>{V(e=>{const n=e.coords.latitude,o=e.coords.longitude;m.fromLatLng(n,o).then(r=>{const i=r.results[0].formatted_address;f.setFieldsValue({online_address:i})},r=>{console.error(r)})})},name:"location",className:"w-[20px] h-[20px] cursor-pointer"})]})}),t(s.Item,{name:"remark",layout:"vertical",label:"\u4ECB\u7ECD",children:t(K,{placeholder:"\u8BF7\u8F93\u5165\u4ECB\u7ECD",autoSize:{minRows:5,maxRows:7}})}),t("div",{className:"flex <sm:fixed-b-btn",children:t(w,{onClick:D,className:"w-[70%] h-[2.75rem] rounded-xl sm:w-[100%]",block:!0,type:"submit",color:"primary",loading:"auto",loadingIcon:t(I,{}),children:"\u4FDD\u5B58"})})]})}),t("div",{onClick:()=>x(-1),className:"fixed top-80px right-40px",children:t($,{fontSize:24,className:"cursor-pointer"})})]})}export{Te as default};
