import{co as Be,a0 as x,u as Ee,aM as Ae,i as ke,s as Ie,k as g,aF as C,r as l,b as e,j as c,S as W,B as De,cp as Le,T as he,a1 as Me,aG as _e}from"./index.5670e6e0.js";import{F as v}from"./index.11c9b67d.js";import{I as Ve}from"./index.66fe089c.js";import{T as Pe}from"./index.21b1b6fd.js";import{C as we}from"./index.1795bad8.js";import{P as He}from"./index.c6660251.js";import{P as me}from"./index.77a6b2f7.js";import{D as Te}from"./index.1dc54ea5.js";import{H as je}from"./index.04556cd2.js";import{P as pe}from"./PickerContent.7accd0df.js";import{H as Re}from"./index.9fe94518.js";import{G as S,I as $e}from"./init.01b19658.js";import{M}from"./manage.653bb3f0.js";import{I as Ye}from"./information.c9048f81.js";import{s as F}from"./index.module.f30b2635.js";import{E as Oe}from"./index.1c39e7a0.js";import{S as re}from"./index.0a2bddee.js";import{I as ie}from"./index.0edfa0b7.js";import{T as qe}from"./index.a27bccdf.js";import{F as h}from"./index.fcc496e2.js";import{S as Ge}from"./Skeleton.c599669d.js";import{D as Ke}from"./index.60148415.js";import{u as ze}from"./index.5733fb44.js";import{d as se}from"./dayjs.min.37299693.js";import{R as fe,C as A}from"./row.06620ecf.js";/* empty css                    *//* empty css                 */import"./is-node-with-content.f661b98b.js";import"./interopRequireDefault.fc5525a1.js";import"./dev-log.6e115cc9.js";import"./index.31244c45.js";import"./index.cb878f88.js";import"./convert-px.daab3cc2.js";import"./CloseCircleFill.55d4b485.js";import"./bound.bddb6539.js";import"./use-gesture-react.esm.346ddc85.js";import"./rubberband.c88fa690.js";import"./isoWeek.f8ad8697.js";import"./PurePanel.2a417db7.js";import"./index.42a6e0fb.js";import"./statusUtils.6dc02607.js";import"./DownOutlined.9a14fa90.js";import"./SearchOutlined.a0283b8c.js";import"./index.a450b78e.js";import"./collapse.e34cf270.js";import"./index.92e459fd.js";import"./useFlexGapSupport.172cfcf4.js";S.setApiKey(Be);S.setLanguage("en");S.setRegion("es");S.setLocationType("ROOFTOP");const{TextArea:Je}=ie;function Ue(V){const{employeeId:P,timeString:d,dateString:b=x().format("YYYY-MM-DD"),customerId:m}=V,q=Ee(),Z=Ae();ke();const N=Ie.getState().global.userInfo,[D]=h.useForm();ze(document.querySelector("body"));const{runAsync:G,loading:K}=g(C.getSubscribeDetail,{manual:!0}),{runAsync:H}=g(M.getStaffSelect,{manual:!0}),{runAsync:w}=g(M.getChannelSelect,{manual:!0}),{runAsync:L}=g(C.checkSubscribe,{manual:!0}),{data:p,loading:z}=g(M.getClientSelect,{defaultParams:[{}],onSuccess(a){var s,i,o,y,E,Y,O,t;if(console.log(a,"LOP"),m){const r=(i=(s=a==null?void 0:a.data)==null?void 0:s.filter(f=>Number(f.id)===Number(m))[0])==null?void 0:i.nickname,n=(y=(o=a==null?void 0:a.data)==null?void 0:o.filter(f=>Number(f.id)===Number(m))[0])==null?void 0:y.phone,u=(Y=(E=a==null?void 0:a.data)==null?void 0:E.filter(f=>Number(f.id)===Number(m))[0])==null?void 0:Y.area,R=(t=(O=a==null?void 0:a.data)==null?void 0:O.filter(f=>Number(f.id)===Number(m))[0])==null?void 0:t.address;D.setFieldsValue({customer:r,phone:n,area:u,address:R})}}}),{data:k,loading:ne}=g(Ye.getInformationList,{defaultParams:[{type:9}]}),{data:T,loading:xe}=g(M.getServerList),I=Z==null?void 0:Z.id,[le,oe]=l.exports.useState([]),ge=h.useWatch("type",D),[be,ue]=l.exports.useState([]),[Q,ye]=l.exports.useState([]),[j,X]=l.exports.useState([]),[J,_]=l.exports.useState(""),[Fe,B]=l.exports.useState(""),[$,Se]=l.exports.useState(b),[ve,ee]=l.exports.useState([]),[te,U]=l.exports.useState(!1),Ne="YYYY/MM/DD",ae=a=>`${Me(a.unix()*1e3)} ${a.format(Ne)}`;l.exports.useEffect(()=>{if(d){const a=d.split(":"),s=a[0],i=a[1]==="0"?"00":a[1];D.setFieldValue("time",se(`${s}:${i}`,"HH:mm"))}else{let a=x().format("H"),s=x().format("mm");s*1===0&&(s="00"),s*1>0&&s*1<=15&&(s=15),s*1>15&&s*1<=30&&(s=30),s*1>30&&s*1<=45&&(s=45),s*1>45&&(s="00",a*1===23?a="0":a=a*1+1),D.setFieldValue("time",se(`${a}:${s}`,"HH:mm"))}},[d]),l.exports.useEffect(()=>{P&&Number(N==null?void 0:N.user_type)===2&&D.setFieldsValue({employee:P})},[P]),l.exports.useEffect(()=>{(async()=>{if(I){const s=await G({id:Number(I)});if(s.status===200){const i=await S.fromAddress(s.data.address),o=x.unix(s.data.start_time);_(s.data.client_id),B(i.status==="OK"?`${i.results[0].geometry.location.lat},${i.results[0].geometry.location.lng}`:""),ee(s.data.extra_ids),D.setFieldsValue({type:String(s.data.server_type),address:i.status==="OK"?s.data.address:"",employee:String(s.data.staff_id),time:se(`${o.format("H")}:${o.format("mm")}`,"HH:mm"),length:String(s.data.duration),price:String(s.data.pay_amount),extra:s.data.extra_ids,note:s.data.remark,customer:s.data.client_name,phone:s.data.client_phone,area:s.data.client_area})}}})()},[I]),l.exports.useEffect(()=>{k&&k.data&&ye(k.data.map(a=>({label:a.label,value:a.value})))},[k]),l.exports.useEffect(()=>{T&&T.data&&T.data.extra&&X(T.data.extra.map(a=>({label:a.name,value:String(a.id)})))},[T]),l.exports.useEffect(()=>{p&&p.data&&oe(p.data.map(a=>({label:`${a.nickname} ${a==null?void 0:a.area} ${a==null?void 0:a.phone}`,value:Number(a.id),email:a.email||"",avatar:a.head||""})))},[p]),l.exports.useEffect(()=>{const a=async()=>{if(N&&N.user_type===1){const{data:i}=await w({type:2});i&&(i==null?void 0:i.length)&&ue(i==null?void 0:i.map(o=>({label:o.channel_name,value:String(o.id)})))}else if(N&&N.user_type===2){const{data:i}=await H({});i&&i.length&&ue(i.map(o=>({label:o.nickname,value:String(o.id)})))}},s=()=>{if(m){_(m);const i=localStorage.getItem("addOrderForm");if(i){const o=JSON.parse(i);ee(o.extra),B(o.latitude),localStorage.removeItem("addOrderForm")}}};a(),s()},[]);const ce=async a=>{var y;const s=a.time.format("H:mm"),i={server_type:Number(a.type),staff_id:a.employee,start_time:x(`${$} ${s}`,"YYYY-MM-DD H:mm").unix(),duration:a.length,price:a.price,extra_ids:(y=a.extra)==null?void 0:y.join(","),remark:a.note||"",latitude:Fe};J&&(i.client_id=J),m&&(i.client_id=m),a.address&&(i.address=a.address);const o=await L({staff_id:a.employee,start_time:x(`${$} ${s}`,"YYYY-MM-DD H:mm").unix()});o.status===205&&_e.show({content:`${o==null?void 0:o.msg}`,closeOnAction:!0,actions:[[{key:"cancel",text:"\u53D6\u6D88",className:"dialog-cancel"},{key:"confirm",text:"\u786E\u5B9A",className:"dialog-confirm",async onClick(){(I?await C.editSubscribe({...i,id:I}):await C.subscribeSave(i)).status===200?q("/calendar",{replace:!0}):U(!1)}}]]}),o.status===200&&(I?await C.editSubscribe({...i,id:I}):await C.subscribeSave(i)).status===200&&q("/calendar",{replace:!0})},de=()=>{q("/manage/add/customer",{state:{from:"pcAddOrder"}})},Ce="H:mm";return e(Ge,{loading:K||z||ne||xe,children:c("div",{className:"min-w-800px flex flex-col justify-center items-center pb-90px",children:[c("div",{className:"text-xl flex z-99 items-center justify-between fixed top-0 bg-[#fff] font-600 py-10 border-b-width-1px text-center border-solid border-color-[#e7eaea] w-full",children:[e("p",{}),e("p",{children:"\u6DFB\u52A0\u65B0\u9884\u7EA6"}),e(W,{name:"nav-cancel",onClick:()=>q("/calendar"),className:"w-[20px] h-[20px] mr-4 cursor-pointer"})]}),c("div",{className:"flex flex-col px-10 pt-30 min-w-900px",children:[c("div",{className:"flex items-center pt-20 relative",children:[e("p",{className:"text-sm font-500 pr-5",children:"\u641C\u7D22\u5BA2\u6237"}),e(re,{style:{flex:1,borderRadius:24},onChange:async a=>{var s,i,o,y,E,Y,O,t;if(a){_(a);const r=(i=(s=p==null?void 0:p.data)==null?void 0:s.filter(f=>Number(f.id)===Number(a))[0])==null?void 0:i.nickname,n=(y=(o=p==null?void 0:p.data)==null?void 0:o.filter(f=>Number(f.id)===Number(a))[0])==null?void 0:y.phone,u=(Y=(E=p==null?void 0:p.data)==null?void 0:E.filter(f=>Number(f.id)===Number(a))[0])==null?void 0:Y.area,R=(t=(O=p==null?void 0:p.data)==null?void 0:O.filter(f=>Number(f.id)===Number(a))[0])==null?void 0:t.address;if(D.setFieldsValue({customer:r,phone:n,area:u,address:R}),R){const f=await S.fromAddress(R);B(f.status==="OK"?`${f.results[0].geometry.location.lat},${f.results[0].geometry.location.lng}`:"")}}},value:J,filterOption:(a,s)=>{var i;return((i=s==null?void 0:s.label)!=null?i:"").toLowerCase().includes(a.toLowerCase())},showSearch:!0,placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",options:le,className:"!bg-[#f8f4f2]"}),c("div",{children:[e(De,{shape:"rounded",className:"ml-2 bg-[#D2693F] w-87px text-color-[#fff]",children:"\u786E\u8BA4"}),e("a",{onClick:de,className:"text-xs w-87px text-center absolute right-0 -bottom-6 underline",children:"\u6DFB\u52A0\u65B0\u5BA2\u6237"})]})]}),c(h,{layout:"vertical",onFinish:ce,form:D,className:"mt-20",children:[c(fe,{gutter:12,children:[e(A,{span:6,children:e(h.Item,{name:"employee",label:(N==null?void 0:N.user_type)===1?"\u6E20\u9053":"\u5458\u5DE5",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:e(re,{options:be,placeholder:"\u8BF7\u9009\u62E9",filterOption:(a,s)=>{var i;return((i=s==null?void 0:s.label)!=null?i:"").toLowerCase().includes(a.toLowerCase())},showSearch:!0})})}),e(A,{span:4,children:e(h.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:e(re,{options:[{label:"\u5802\u98DF",value:"1"},{label:"\u5916\u5356",value:"2"}],placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"})})}),Number(ge)===2&&e(A,{span:14,children:c("div",{className:"relative flex items-center",children:[e(h.Item,{name:"address",label:"\u5730\u5740",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],className:"w-full",children:e($e,{onConfirm:a=>{B(`${a==null?void 0:a.geometry.location.lat()},${a==null?void 0:a.geometry.location.lng()}`)},transparent:!0,style:{background:"#f2f5f5",padding:"6px 10px"}})}),e(W,{name:"location-calendar",className:"w-[24px] h-[32px] cursor-pointer pt-2",onClick:()=>{Le(a=>{const s=a.coords.latitude,i=a.coords.longitude;S.fromLatLng(s,i).then(o=>{const y=o.results[0].formatted_address;D.setFieldValue("address",y),B(`${s},${i}`)},o=>{he.show("Server returned status code ZERO_RESULTS"),console.error(o)})})}})]})})]}),c("div",{children:[c(fe,{gutter:12,children:[e(A,{span:6,children:e(h.Item,{initialValue:se(b),name:"date",label:"\u65E5\u671F",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:e(Ke,{onChange:a=>{Se(se(a).format("YYYY/MM/DD"))},placeholder:"\u8BF7\u9009\u62E9\u65F6\u95F4",allowClear:!1,format:a=>ae(a),className:""})})}),e(A,{span:6,children:e(h.Item,{name:"time",label:"\u65F6\u95F4",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:e(qe,{showNow:!1,minuteStep:15,format:Ce,placeholder:"\u8BF7\u9009\u62E9\u65F6\u95F4"})})}),e(A,{span:6,children:e(h.Item,{name:"length",label:"\u65F6\u957F",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:e(re,{options:Q,placeholder:"\u8BF7\u9009\u62E9\u65F6\u957F"})})}),e(A,{span:6,children:e(h.Item,{className:F.price,name:"price",label:"\u4EF7\u683C",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:e(ie,{addonBefore:"$"})})})]}),e(h.Item,{name:"extra",label:"\u989D\u5916\u670D\u52A1",initialValue:[],children:e(re,{options:j,placeholder:"\u8BF7\u9009\u62E9\u989D\u5916\u670D\u52A1",mode:"multiple"})}),c(fe,{gutter:24,children:[e(A,{span:12,children:e(h.Item,{className:F.custname,name:"customer",label:"\u5BA2\u6237\uFF08\u9009\u586B\uFF09",children:e(ie,{disabled:!0})})}),e(A,{span:12,children:e(h.Item,{className:F.custname,name:"phone",label:"\u8054\u7CFB\u65B9\u5F0F\uFF08\u9009\u586B\uFF09",children:e(ie,{disabled:!0})})})]}),e(h.Item,{hidden:!0,noStyle:!0,name:"area",children:e(ie,{readOnly:!0})})]}),e(fe,{children:e(A,{span:24,children:e(h.Item,{name:"note",className:F.area,label:"\u5907\u6CE8\uFF08\u9009\u586B\uFF09",children:e(Je,{placeholder:"\u8F93\u5165"})})})}),e("div",{className:"",children:e(De,{className:"h-[36px] w-100px rounded-3xl",type:"submit",color:"primary",loadingIcon:e(Oe,{}),loading:te,children:"\u4FDD\u5B58"})})]})]})]})})}S.setApiKey(Be);S.setLanguage("en");S.setRegion("es");S.setLocationType("ROOFTOP");function Rt(){var y,E,Y,O;const V=Ee(),P=Ae(),d=ke(),b=Ie.getState().global.userInfo,[m]=v.useForm(),{runAsync:q}=g(C.getSubscribeDetail,{manual:!0}),{runAsync:Z}=g(M.getStaffSelect,{manual:!0}),{runAsync:N}=g(M.getChannelSelect,{manual:!0}),{runAsync:D}=g(C.checkSubscribe,{manual:!0}),{data:G}=g(M.getClientSelect,{defaultParams:[{}]}),{data:K}=g(Ye.getInformationList,{defaultParams:[{type:9}]}),{data:H}=g(M.getServerList),w=P==null?void 0:P.id,L=(y=d==null?void 0:d.state)==null?void 0:y.customerId,p=((E=d==null?void 0:d.state)==null?void 0:E.dateString)||x().format("YYYY-MM-DD"),z=((Y=d==null?void 0:d.state)==null?void 0:Y.timeString)||"",k=((O=d==null?void 0:d.state)==null?void 0:O.employeeId)||"",[ne,T]=l.exports.useState([]),[xe]=l.exports.useState([{label:"\u5802\u98DF",value:"1"},{label:"\u5916\u5356",value:"2"}]),I=v.useWatch("type",m),[le,oe]=l.exports.useState([]),[ge]=l.exports.useState(()=>{const t=[],r=[];for(let n=0;n<60;n++)if(n<24){const u=String(n);t.push({label:u,value:u})}return r.push({label:"00",value:"00"},{label:"15",value:"15"},{label:"30",value:"30"},{label:"45",value:"45"}),[t,r]}),[be,ue]=l.exports.useState([]),[Q,ye]=l.exports.useState([]),[j,X]=l.exports.useState(""),[J,_]=l.exports.useState(""),[Fe,B]=l.exports.useState(!1),[$,Se]=l.exports.useState(p),[ve,ee]=l.exports.useState(!1),[te,U]=l.exports.useState([]),[Ne,ae]=l.exports.useState(!1),[ce,de]=l.exports.useState(!1);l.exports.useEffect(()=>{if(z){const t=z.split(":"),r=t[0],n=t[1]==="0"?"00":t[1];m.setFieldValue("time",[r,n])}else{let t=x().format("H"),r=x().format("mm");r*1===0&&(r="00"),r*1>0&&r*1<=15&&(r=15),r*1>15&&r*1<=30&&(r=30),r*1>30&&r*1<=45&&(r=45),r*1>45&&(r="00",t*1===23?t="0":t=t*1+1),m.setFieldValue("time",[`${t}`,`${r}`])}},[z]),l.exports.useEffect(()=>{k&&m.setFieldsValue({employee:[k]})},[k]),l.exports.useEffect(()=>{(async()=>{if(w){const r=await q({id:Number(w)});if(r.status===200){const n=await S.fromAddress(r.data.address),u=x.unix(r.data.start_time);X(r.data.client_id),_(n.status==="OK"?`${n.results[0].geometry.location.lat},${n.results[0].geometry.location.lng}`:""),U(r.data.extra_ids),m.setFieldsValue({type:[String(r.data.server_type)],address:n.status==="OK"?r.data.address:"",employee:[String(r.data.staff_id)],time:[u.format("H"),u.format("mm")],length:[String(r.data.duration)],price:String(r.data.pay_amount),extra:r.data.extra_ids,note:r.data.remark})}}})()},[w]),l.exports.useEffect(()=>{K&&K.data&&ue(K.data.map(t=>({label:t.label,value:t.value})))},[K]),l.exports.useEffect(()=>{H&&H.data&&H.data.extra&&ye(H.data.extra.map(t=>({label:t.name,value:String(t.id)})))},[H]),l.exports.useEffect(()=>{G&&G.data&&T(G.data.map(t=>({label:t.nickname,value:String(t.id),email:t.email||"",avatar:t.head||""})))},[G]),l.exports.useEffect(()=>{const t=async()=>{if(b&&b.user_type===1){const{data:n}=await N({type:2});n&&(n==null?void 0:n.length)&&oe(n==null?void 0:n.map(u=>({label:u.channel_name,value:String(u.id)})))}else if(b&&b.user_type===2){const{data:n}=await Z({});n&&n.length&&oe(n.map(u=>({label:u.nickname,value:String(u.id)})))}},r=()=>{if(L){X(L);const n=localStorage.getItem("addOrderForm");if(n){const u=JSON.parse(n);m.setFieldsValue(u),U(u.extra),_(u.latitude),localStorage.removeItem("addOrderForm")}}};t(),r()},[]);const Ce=async t=>{if(ce)return!1;de(!0);const r={server_type:Number(t.type[0]),staff_id:t.employee[0],start_time:x(`${$} ${t.time[0]}:${t.time[1]}`,"YYYY-MM-DD H:mm").unix(),duration:t.length[0],price:t.price,extra_ids:t.extra.join(","),remark:t.note||"",latitude:J};L&&(r.client_id=L),t.address&&(r.address=t.address);const n=await D({staff_id:t.employee[0],start_time:x(`${$} ${t.time[0]}:${t.time[1]}`,"YYYY-MM-DD H:mm").unix()});n.status===205&&_e.show({content:`${n==null?void 0:n.msg}`,closeOnAction:!0,actions:[[{key:"cancel",text:"\u53D6\u6D88",className:"dialog-cancel"},{key:"confirm",text:"\u786E\u5B9A",className:"dialog-confirm",async onClick(){(w?await C.editSubscribe({...r,id:w}):await C.subscribeSave(r)).status===200&&V("/calendar",{replace:!0})}}]]}),n.status===200&&(w?await C.editSubscribe({...r,id:w}):await C.subscribeSave(r)).status===200&&V("/calendar",{replace:!0}),de(!1)},a=(t,r)=>{r.current&&r.current.open()},s=()=>{var t,r,n;if(j&&i)B(!0);else{const u={...m.getFieldsValue(!0),latitude:J};localStorage.setItem("addOrderForm",JSON.stringify(u)),V("/manage/customer/list",{state:{from:"addOrder",dateString:(t=d==null?void 0:d.state)==null?void 0:t.dateString,timeString:(r=d==null?void 0:d.state)==null?void 0:r.timeString,employeeId:(n=d==null?void 0:d.state)==null?void 0:n.employeeId}})}},i=l.exports.useMemo(()=>{const t=ne.find(r=>r.value===String(j));return t?[t.label,t.email,t.avatar]:""},[j,ne]),o=l.exports.useMemo(()=>x($,"YYYY-MM-DD").format("dddd YYYY/MM/DD").split(" "),[$]);return c("div",{className:`${F.AddOrderForm} pt-[48px] pb-[90px] sm:pt-0 sm:pb-0 !sm:w-full`,children:[e(je,{renderLeft:!1,onBack:()=>V("/calendar")}),c("div",{className:"flex flex-col px-10 py-12 sm:hidden",children:[e("p",{className:"text-2xl font-600 pb-10",children:w?"\u7F16\u8F91\u9884\u7EA6":"\u6DFB\u52A0\u65B0\u9884\u7EA6"}),c("div",{className:`${F.BorderedSelectItem} flex items-center justify-between py-3 pr-1 mb-6`,onClick:s,children:[j&&i?c("div",{className:"flex items-center",children:[e("div",{className:`${F.CustomerAvatar} flex items-center justify-center`,children:i[2]?e("img",{src:i[2]}):e("div",{children:i[0][0].toUpperCase()})}),c("div",{className:"flex flex-col ml-4",children:[e("span",{className:"text-base font-600",children:i[0]}),e("span",{className:"text-xs text-color-[#999]",children:i[1]})]})]}):e("span",{className:"text-[12px] text-color-[#9a9a9a]",children:"\u6DFB\u52A0\u65B0\u5BA2\u6237"}),e(W,{name:j&&i?"point":"add-customer-calendar",className:"w-[12px] h-[12px]"})]}),c("div",{className:`${F.BorderedSelectItem} flex items-center justify-between py-3 pr-1 mb-14`,onClick:()=>{ee(!0)},children:[c("div",{className:"flex flex-col",children:[e("span",{className:"text-lg font-600",children:o[0]}),e("span",{className:"text-xs text-color-[#B5B5B5]",children:o[1]})]}),e(W,{name:"caret-right",className:"w-[6px] h-[9px]"})]}),e(Re,{actions:[{text:"\u67E5\u770B\u8D44\u6599",key:"view",onClick:()=>{V("/manage/customer/info",{state:{id:L}}),B(!1)}},{text:"\u5220\u9664",key:"delete",danger:!0,onClick:()=>{X(""),B(!1)}}],visible:Fe,setVisible:B}),e(Te,{visible:ve,value:x($,"YYYY-MM-DD").toDate(),onClose:()=>{ee(!1)},onConfirm:t=>{Se(x(t).format("YYYY-MM-DD"))}}),c(v,{layout:"horizontal",onFinish:Ce,footer:null,form:m,children:[e(v.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],trigger:"onConfirm",onClick:a,children:e(me,{columns:[xe],children:t=>e(pe,{val:t,textType:"normal"})})}),I==2&&c("div",{className:"relative flex items-center",children:[e(v.Item,{name:"address",label:"\u5730\u5740",rules:[{required:!0}],children:e($e,{transparent:!0,onConfirm:t=>{_(`${t==null?void 0:t.geometry.location.lat()},${t==null?void 0:t.geometry.location.lng()}`)}})}),e(W,{name:"location-calendar",className:"w-[12px] h-[16px] absolute z-1",style:{right:8,top:56},onClick:()=>{Le(t=>{const r=t.coords.latitude,n=t.coords.longitude;S.fromLatLng(r,n).then(u=>{const R=u.results[0].formatted_address;m.setFieldValue("address",R),_(`${r},${n}`)},u=>{he.show("Server returned status code ZERO_RESULTS"),console.error(u)})})}})]}),e(v.Item,{name:"employee",label:(b==null?void 0:b.user_type)===1?"\u6E20\u9053":"\u5458\u5DE5",rules:[{required:!0}],trigger:"onConfirm",onClick:(t,r)=>{if(le.length===0)return he.show((b==null?void 0:b.user_type)===1?"\u6682\u65E0\u6E20\u9053\u5217\u8868\uFF0C\u8BF7\u5148\u6DFB\u52A0\u6E20\u9053":"\u6682\u65E0\u5458\u5DE5\u5217\u8868\uFF0C\u8BF7\u5148\u6DFB\u52A0\u5458\u5DE5");a(t,r)},children:e(me,{columns:[le],children:t=>e(pe,{val:t,textType:"normal"})})}),c("div",{children:[e(v.Item,{name:"time",label:"\u65F6\u95F4",className:F.halfFormItem,rules:[{required:!0}],trigger:"onConfirm",onClick:a,children:e(me,{columns:ge,children:t=>e(pe,{val:t,textType:"time"})})}),e(v.Item,{name:"length",label:"\u65F6\u957F",className:F.halfFormItem,rules:[{required:!0}],trigger:"onConfirm",onClick:a,children:e(me,{columns:[be],children:t=>e(pe,{val:t,textType:"normal"})})}),c("div",{className:`${F.halfFormItem} flex flex-shrink-0 items-center relative`,children:[e("span",{className:"text-[14px] mr-4px absolute z-1 top-[58px] left-[8px]",children:"$"}),e(v.Item,{name:"price",label:"\u4EF7\u683C",className:F.prefixInputItem,rules:[{required:!0}],children:e(Ve,{})})]}),c(v.Item,{name:"extra",label:"\u989D\u5916\u670D\u52A1",className:F.halfFormItem,initialValue:te,onClick:()=>{Q.length>0?ae(!0):he.show("\u65E0\u989D\u5916\u670D\u52A1")},children:[c("div",{className:"flex items-center justify-between min-h-[21px]",children:[e("span",{className:"whitespace-nowrap overflow-hidden overflow-ellipsis",children:Q.filter(t=>te.includes(t.value)).map(t=>t.label).join(", ")}),e(W,{name:"caret-down",className:"w-[10px] h-[6px] fill-[#2A4948]"})]}),e(He,{visible:Ne,bodyStyle:{maxHeight:"80vh",borderRadius:"20px 20px 0 0"},children:c(we,{value:te,multiple:!0,onChange:t=>{U(t),m.setFieldValue("extra",t)},children:[c("div",{className:"flex justify-between px-4 py-2",children:[e("p",{onClick:()=>{m.setFieldsValue({extra:[""]}),U([]),ae(!1)},children:"\u53D6\u6D88"}),e("p",{onClick:()=>{ae(!1)},children:"\u786E\u5B9A"})]}),Q.map((t,r)=>e(we.Item,{value:t.value,children:t.label},r))]})})]})]}),e(v.Item,{name:"note",label:"\u5907\u6CE8",children:e(Pe,{placeholder:"\u8F93\u5165"})}),e("div",{className:"fixed-b-btn",children:e(De,{className:"w-[65%] h-[2.75rem] rounded-3xl",block:!0,type:"submit",color:"primary",loadingIcon:e(Oe,{}),loading:ce,children:"\u4FDD\u5B58"})})]})]}),e("div",{className:"<sm:hidden sm:flex sm:justify-center sm:items-center",children:e(Ue,{dateString:p,employeeId:k,timeString:z,customerId:L})})]})}export{Rt as default};
