import{r as m,s as M,k as q,b as e,F as ee,j as I,S as fe,B as Q,f as te,T as P,aL as be,co as se,aD as _e,cW as Ve,cZ as We,d9 as Ee,da as Ne,db as Se,cD as G,dc as ve,cC as Ae,cJ as ge,dd as Be,W as ze,u as pe,_ as oe,i as Oe,O as Ge}from"./index.5670e6e0.js";import{S as J}from"./index.3e941e25.js";import{S as Le}from"./Skeleton.c599669d.js";import{H as Ke}from"./index.04556cd2.js";import{C as we}from"./index.1795bad8.js";import{F as d,d as Ye}from"./index.11c9b67d.js";import{I as U}from"./index.66fe089c.js";import{P as He,i as X}from"./index.77a6b2f7.js";import{P as Je}from"./index.c6660251.js";import{I as D}from"./information.c9048f81.js";import{d as le,_ as Ze}from"./differenceWith.1f2b7854.js";import{T as ue,c as Qe}from"./TimePriceItem.1fe90ca6.js";import{T as xe}from"./index.21b1b6fd.js";import{p as Fe}from"./pickBy.15fa557e.js";import{E as $e}from"./index.1c39e7a0.js";import{G as O,I as Re}from"./init.01b19658.js";import{M as Z}from"./manage.653bb3f0.js";import{P as ce}from"./personal.dd90e075.js";import{U as de}from"./upload.3b886abe.js";import Xe from"./Service.9736c7d6.js";import{u as Pe}from"./index.5733fb44.js";import{S as me}from"./index.0a2bddee.js";import{R as ae,C as K}from"./row.06620ecf.js";/* empty css                    *//* empty css                 */import"./dev-log.6e115cc9.js";import"./use-gesture-react.esm.346ddc85.js";import"./bound.bddb6539.js";import"./is-node-with-content.f661b98b.js";import"./interopRequireDefault.fc5525a1.js";import"./index.31244c45.js";import"./index.cb878f88.js";import"./convert-px.daab3cc2.js";import"./CloseCircleFill.55d4b485.js";import"./rubberband.c88fa690.js";import"./last.7ecc4488.js";import"./index.88567fed.js";import"./native-input.0c0515ca.js";import"./index.96cf7cd4.js";import"./index.af3e2847.js";import"./PurePanel.2a417db7.js";import"./index.42a6e0fb.js";import"./statusUtils.6dc02607.js";import"./DownOutlined.9a14fa90.js";import"./SearchOutlined.a0283b8c.js";import"./useFlexGapSupport.172cfcf4.js";function De(l,t){return m.exports.isValidElement(l)&&t.indexOf(l.type.muiName)!==-1}const et="_AddEmployeeForm_1hzpk_1",tt="_input_1hzpk_12",st="_priceForm_1hzpk_16",it="_raceContainer_1hzpk_65",nt="_dineIn_1hzpk_74",rt="_price_1hzpk_16",at="_takeOut_1hzpk_116",ot="_imgslist_1hzpk_158",S={AddEmployeeForm:et,input:tt,priceForm:st,"adm-list-item-disabled":"_adm-list-item-disabled_1hzpk_50",raceContainer:it,dineIn:nt,price:rt,takeOut:at,imgslist:ot};function lt(l){var E;const{extendData:t,langList:a,next:s,nickname:f,swiperIndex:_}=l,b=M.getState().global.employeeForm,[h]=d.useForm(),[u,F]=m.exports.useState(!1),[g,w]=m.exports.useState([]),{data:C,loading:k}=q(()=>D.getInformationList({type:1}));m.exports.useEffect(()=>{if(t!=null&&t.data){let n=t==null?void 0:t.data;b&&(n=b),h.setFieldsValue({age:n.age,weight:n.weight,height:n.height,chest:n.chest}),n!=null&&n.race&&h.setFieldsValue({race:[n==null?void 0:n.race]}),n!=null&&n.lang_ids&&(h.setFieldsValue({lang:A(n==null?void 0:n.lang_ids)}),w(n==null?void 0:n.lang_ids))}},[_,t]);const A=n=>{var x;let c="";return(x=a==null?void 0:a.data)==null||x.map(p=>{n.map(o=>{`${p.value}`==`${o}`&&(c+=p.label+",")})}),c},L=n=>{var c;if(n.race=n.race[0],!g.length)return!1;n.lang_ids=g,(c=t==null?void 0:t.data)!=null&&c.id&&(n.id=t.data.id),n.nickname=f,M.dispatch(te(n)),s()};return k?e(ee,{}):e("div",{className:"flex flex-col px-8 py-20",children:I(d,{form:h,requiredMarkStyle:"none",layout:"horizontal",onFinish:L,footer:null,children:[e(d.Item,{label:"\u5E74\u9F84*",children:I("div",{className:`${S.input} flex items-center`,children:[e(d.Item,{noStyle:!0,name:"age",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5408\u6CD5\u5E74\u9F84",validator:(n,c,x)=>c<18?Promise.reject("\u8BF7\u8F93\u5165\u5408\u6CD5\u5E74\u9F84"):Promise.resolve(!0)}],children:e(U,{placeholder:"\u5E74\u9F84"})}),e("p",{className:"text-xs pr-4 min-w-34px",children:"\u5C81"})]})}),e(d.Item,{label:"\u4F53\u91CD*",children:I("div",{className:`${S.input} flex items-center`,children:[e(d.Item,{noStyle:!0,name:"weight",rules:[{required:!0}],children:e(U,{placeholder:"\u4F53\u91CD"})}),e("p",{className:"text-xs pr-4 min-w-34px",children:"kg"})]})}),e(d.Item,{label:"\u8EAB\u9AD8*",children:I("div",{className:`${S.input} flex items-center`,children:[e(d.Item,{noStyle:!0,name:"height",rules:[{required:!0}],children:e(U,{placeholder:"\u8EAB\u9AD8"})}),e("p",{className:"text-xs pr-4 min-w-34px",children:"cm"})]})}),e(d.Item,{label:"\u80F8\u56F4*",children:e("div",{className:`${S.input} flex items-center`,children:e(d.Item,{noStyle:!0,name:"chest",rules:[{required:!0}],children:e(U,{placeholder:"\u80F8\u56F4"})})})}),e(d.Item,{name:"race",trigger:"onConfirm",label:"\u4EBA\u79CD*",onClick:(n,c)=>{var x;(x=c.current)==null||x.open()},rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4EBA\u79CD"}],className:S.raceContainer,children:e(He,{columns:[C==null?void 0:C.data],children:n=>{var c;return e("span",{className:"text-xs pl-4 flex items-center h-38px",children:((c=n[0])==null?void 0:c.label)||""})}})}),e(d.Item,{label:"\u8BED\u8A00*",children:I("div",{onClick:()=>F(!0),className:`${S.input} flex items-center`,children:[e(d.Item,{noStyle:!0,name:"lang",children:e(U,{placeholder:"",readOnly:!0})}),e(fe,{name:"phone-bottom",className:"w-[10px] h-[6px] mr-4"})]})}),e(Je,{visible:u,onMaskClick:()=>{F(!1)},destroyOnClose:!0,children:e("div",{className:S.checkListContainer,children:e(we,{multiple:!0,className:S.myCheckList,value:g,onChange:n=>{h.setFieldsValue({lang:A(n)}),w(n)},children:(E=a==null?void 0:a.data)==null?void 0:E.map(n=>e(we.Item,{value:`${n.value}`,children:n==null?void 0:n.label},n.id))})})}),e("div",{className:"flex justify-center mt-10",children:e(Q,{className:"w-[100%] h-[2.75rem]",block:!0,type:"submit",color:"primary",shape:"rounded",children:"\u4E0B\u4E00\u6B65"})})]})})}function ut(l){const{next:t,timePicker:a,extendData:s,swiperIndex:f,swipeNext:_,serviceList:b,value:h}=l,[u]=d.useForm(),F=M.getState().global.employeeForm,[g,w]=m.exports.useState(),[C,k]=m.exports.useState(),[A,L]=m.exports.useState("%");m.exports.useEffect(()=>{var c,x,p,o;if(s!=null&&s.data){let r=s==null?void 0:s.data;L("$"),F.sales_cost&&F.server_ids&&(r=F),r.sales_cost&&(((c=r.sales_cost.eat_in)==null?void 0:c.length)>0?w(r.sales_cost.eat_in):w([{}]),((x=r.sales_cost.take_out)==null?void 0:x.length)>0?k(r.sales_cost.take_out):k([{}])),r.cost&&(((p=r.cost.eat_in)==null?void 0:p.length)>0?w(r.cost.eat_in):w([{}]),((o=r.cost.take_out)==null?void 0:o.length)>0?k(r.cost.take_out):k([{}]))}},[f,s]);const E=()=>{u.validateFields().then(c=>{const x=[];if(g){let o={};Object.keys(g).map(r=>{o={price:c.eat_in[`price_${r}`],time:c.eat_in[`time_${r}`][0]},x.push(o)})}const p=[];if(C){let o={};Object.keys(C).map(r=>{o={price:c.take_out[`price_${r}`],time:c.take_out[`time_${r}`][0]},p.push(o)})}if(c.sales_cost={eat_in:le(x,[{time:void 0,price:void 0},{time:"",price:""}],X),take_out:le(p,[{time:void 0,price:void 0},{time:"",price:""}],X)},!c.sales_cost.eat_in.length&&!c.sales_cost.take_out.length)return P.show("\u5916\u5356/\u5802\u98DF\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A");c.sales_cost.eat_in.length&&c.sales_cost.eat_in.map(o=>{if(!o.price||!o.time)throw P.show("\u8BF7\u5B8C\u5584\u6216\u6E05\u7A7A")}),c.sales_cost.take_out.length&&c.sales_cost.take_out.map(o=>{if(!o.price||!o.time)throw P.show("\u8BF7\u5B8C\u5584\u6216\u6E05\u7A7A")}),c.server_ids=h,delete c.take_out,delete c.eat_in,M.dispatch(te({...c,...F})),t()})},n=()=>{var p,o;const c=[...(p=s==null?void 0:s.data)==null?void 0:p.basis,...(o=s==null?void 0:s.data)==null?void 0:o.extra];console.log("props",l);const x=be(h,function(r){return r*1});if(x.length===c.length)return`\u5168\u90E8\u9879\u76EE\uFF08${c.length}\uFF09`;{const r=be(c.filter(v=>x.includes(v.id)),"name");return`${r.join(",")}\uFF08${r.length}\uFF09`}};return I("div",{className:"bg-[#fff] flex flex-col relative pt-10  min-h-[100vh]",children:[e("div",{className:"flex flex-col px-4",children:I(d,{requiredMarkStyle:"none",layout:"horizontal",form:u,footer:null,children:[e("p",{className:"pb-4 py-12",children:"\u6536\u8D39\u6807\u51C6"}),A==="$"&&I(ee,{children:[e(d.Item,{className:`${S.dineIn} mt-4`,name:"eat_in",label:"\u5802\u98DF",children:e(ue,{form:u,timePicker:a,list:g,setList:w,keyTitle:"eat_in"})}),e(d.Item,{className:`${S.takeOut}`,name:"take_out",label:"\u5916\u5356",children:e(ue,{timePicker:a,list:C,setList:k,keyTitle:"take_out",form:u})})]}),e("p",{className:"pt-12 pb-4",children:"\u53EF\u63D0\u4F9B\u670D\u52A1"}),e(d.Item,{children:I("div",{className:`${S.input} flex items-center py-1 justify-between`,children:[e("div",{className:"text-color-[#ccc] text-xs pl-4",children:n()}),e(Q,{onClick:()=>{E()},size:"mini",fill:"none",className:"pr-4 underline min-w-[4rem]",children:e("span",{className:"text-xs",children:"\u7F16\u8F91"})})]})})]})}),e("div",{onClick:E,className:"flex justify-center mt-10",children:e(Q,{className:"w-[90%] h-[2.75rem]",block:!0,type:"submit",color:"primary",shape:"rounded",children:"\u4E0B\u4E00\u6B65"})})]})}O.setApiKey(se);O.setLanguage("en");O.setRegion("es");O.setLocationType("ROOFTOP");const ct=l=>{const{next:t,extendData:a,swiperIndex:s}=l,[f]=d.useForm(),_=M.getState().global.employeeForm,b=async()=>{await f.validateFields().then(h=>{h=Fe(h,_e),M.dispatch(te({..._,...h})),t()})};return m.exports.useEffect(()=>{if(a!=null&&a.data){let h=a==null?void 0:a.data;_.street&&(h=_),f.setFieldsValue({street:h.street||h.address||"",house_num:h.house_num,bell:h.bell,remark:h.remark})}},[s,a]),I("div",{className:"flex h-full flex-col px-8 py-20",children:[e("p",{className:"text-lg pb-8 font-500",children:"\u5730\u5740\u4FE1\u606F"}),I(d,{requiredMarkStyle:"none",layout:"horizontal",form:f,footer:null,children:[e(d.Item,{label:"\u8857\u9053*",children:e("div",{className:"flex items-center justify-between",children:e(d.Item,{noStyle:!0,name:"street",rules:[{required:!0}],children:e(Re,{})})})}),e(d.Item,{label:"\u95E8\u724C\u53F7",children:e("div",{className:`${S.input} flex items-center`,children:e(d.Item,{noStyle:!0,name:"house_num",children:e(U,{placeholder:"\u95E8\u724C\u53F7"})})})}),e(d.Item,{label:"\u6309\u94C3\u65B9\u5F0F",children:e("div",{className:`${S.input} flex items-center`,children:e(d.Item,{noStyle:!0,name:"bell",children:e(U,{placeholder:"\u6309\u94C3\u65B9\u5F0F"})})})}),e(d.Item,{name:"remark",label:"\u5907\u6CE8",children:e(xe,{placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",autoSize:{minRows:5,maxRows:7}})}),e("div",{className:"flex justify-center mt-10",children:e(Q,{onClick:b,className:"w-[100%] h-[2.75rem]",block:!0,type:"submit",color:"primary",shape:"rounded",loading:"auto",loadingIcon:e($e,{}),children:"\u4E0B\u4E00\u6B65"})})]})]})};function dt(l,t,a,s){for(var f=a-1,_=l.length;++f<_;)if(s(l[f],t))return f;return-1}var mt=dt,pt=Ve,ht=Ze,ft=mt,gt=We,_t=Ye,xt=Array.prototype,ke=xt.splice;function Ft(l,t,a,s){var f=s?ft:ht,_=-1,b=t.length,h=l;for(l===t&&(t=_t(t)),a&&(h=pt(l,gt(a)));++_<b;)for(var u=0,F=t[_],g=a?a(F):F;(u=f(h,g,u,s))>-1;)h!==l&&ke.call(h,u,1),ke.call(l,u,1);return l}var yt=Ft,It=yt;function bt(l,t,a){return l&&l.length&&t&&t.length?It(l,t,void 0,a):l}var je=bt;function wt(l){return Ee("MuiImageList",l)}Ne("MuiImageList",["root","masonry","quilted","standard","woven"]);const kt=m.exports.createContext({}),Te=kt,Ct=["children","className","cols","component","rowHeight","gap","style","variant"],Et=l=>{const{classes:t,variant:a}=l;return Be({root:["root",a]},wt,t)},Nt=Se("ul",{name:"MuiImageList",slot:"Root",overridesResolver:(l,t)=>{const{ownerState:a}=l;return[t.root,t[a.variant]]}})(({ownerState:l})=>G({display:"grid",overflowY:"auto",listStyle:"none",padding:0,WebkitOverflowScrolling:"touch"},l.variant==="masonry"&&{display:"block"})),St=m.exports.forwardRef(function(t,a){const s=ve({props:t,name:"MuiImageList"}),{children:f,className:_,cols:b=2,component:h="ul",rowHeight:u="auto",gap:F=4,style:g,variant:w="standard"}=s,C=Ae(s,Ct),k=m.exports.useMemo(()=>({rowHeight:u,gap:F,variant:w}),[u,F,w]);m.exports.useEffect(()=>{},[]);const A=w==="masonry"?G({columnCount:b,columnGap:F},g):G({gridTemplateColumns:`repeat(${b}, 1fr)`,gap:F},g),L=G({},s,{component:h,gap:F,rowHeight:u,variant:w}),E=Et(L);return e(Nt,G({as:h,className:ge(E.root,E[w],_),ref:a,style:A,ownerState:L},C,{children:e(Te.Provider,{value:k,children:f})}))}),vt=St;function At(l){return Ee("MuiImageListItem",l)}const Bt=Ne("MuiImageListItem",["root","img","standard","woven","masonry","quilted"]),Ce=Bt,Ot=["children","className","cols","component","rows","style"],Lt=l=>{const{classes:t,variant:a}=l;return Be({root:["root",a],img:["img"]},At,t)},$t=Se("li",{name:"MuiImageListItem",slot:"Root",overridesResolver:(l,t)=>{const{ownerState:a}=l;return[{[`& .${Ce.img}`]:t.img},t.root,t[a.variant]]}})(({ownerState:l})=>G({display:"block",position:"relative"},l.variant==="standard"&&{display:"flex",flexDirection:"column"},l.variant==="woven"&&{height:"100%",alignSelf:"center","&:nth-of-type(even)":{height:"70%"}},{[`& .${Ce.img}`]:G({objectFit:"cover",width:"100%",height:"100%",display:"block"},l.variant==="standard"&&{height:"auto",flexGrow:1})})),Rt=m.exports.forwardRef(function(t,a){const s=ve({props:t,name:"MuiImageListItem"}),{children:f,className:_,cols:b=1,component:h="li",rows:u=1,style:F}=s,g=Ae(s,Ot),{rowHeight:w="auto",gap:C,variant:k}=m.exports.useContext(Te);let A="auto";k==="woven"?A=void 0:w!=="auto"&&(A=w*u+C*(u-1));const L=G({},s,{cols:b,component:h,gap:C,rowHeight:w,rows:u,variant:k}),E=Lt(L);return e($t,G({as:h,className:ge(E.root,E[k],_),ref:a,style:G({height:A,gridColumnEnd:k!=="masonry"?`span ${b}`:void 0,gridRowEnd:k!=="masonry"?`span ${u}`:void 0,marginBottom:k==="masonry"?C:void 0},F),ownerState:L},g,{children:m.exports.Children.map(f,n=>m.exports.isValidElement(n)?n.type==="img"||De(n,["Image"])?m.exports.cloneElement(n,{className:ge(E.img,n.props.className)}):n:null)}))}),Pt=Rt;function Ue(l){const{itemData:t,deleteImg:a}=l,s=["mp4","mkv","avi","mov","wmv","flv","webm"];return e(ee,{children:(()=>e(vt,{classes:{root:S.imgslist},className:"imageList sm:w-300px",children:t==null?void 0:t.map((_,b)=>{var F;const u=(F=((_==null?void 0:_.split("."))||[]).slice(-1))==null?void 0:F[0];return s!=null&&s.includes(u)?I("div",{className:"relative",children:[e("video",{src:`${_}#t=0.5`,width:"320",height:"240",controls:!0,preload:"metadata",children:e("source",{src:`${_}#t=0.5`,type:`video/${u}`})}),e(fe,{onClick:()=>a(b),name:"delete-img",className:"w-[25px] h-[25px] absolute -right-3 -top-3 z-10"})]},b):e(Pt,{sx:{overflowY:"inherit"},children:I("div",{className:"relative",children:[e(ze,{src:`${_}`,className:"rounded-lg mb-2"}),e(fe,{onClick:()=>a(b),name:"delete-img",className:"w-[25px] h-[25px] absolute -right-3 -top-3 z-10"})]})},_)})}))()})}O.setApiKey(se);O.setLanguage("en");O.setRegion("es");O.setLocationType("ROOFTOP");const jt=l=>{const{extendData:t,isUserOnline:a}=l,[s]=d.useForm(),[f,_]=m.exports.useState([]),[b,h]=m.exports.useState(""),[u,F]=m.exports.useState(!1),[g,w]=m.exports.useState(!1),C=M.getState().global.employeeForm,k=pe(),A=m.exports.useRef(null),L=m.exports.useRef(null),E=async p=>{const o=[...p.target.files];if(o.length){F(!0);const r=await de.uploadFile(o);(r==null?void 0:r.status)===200&&(P.show(r.data.msg),_(()=>{var v,B;return[...f,(B=(v=r==null?void 0:r.data)==null?void 0:v.data)==null?void 0:B.file_url]})),F(!1)}},n=async p=>{var r,v;const o=[...p.target.files];if(o.length){w(!0);const B=await de.uploadFile(o);(B==null?void 0:B.status)===200&&(P.show(B.data.msg),h((v=(r=B==null?void 0:B.data)==null?void 0:r.data)==null?void 0:v.file_url)),w(!1)}};m.exports.useEffect(()=>{var p,o,r,v;if(t!=null&&t.data){if(a){const B=[];(r=(o=t==null?void 0:t.data)==null?void 0:o.picture)==null||r.map((V,W)=>{W>0?B.push(V):h(V)}),_(B)}else{const B=[];(p=t==null?void 0:t.data)==null||p.picture.map((V,W)=>{W>0?B.push(V.url):h(V.url)}),_(B)}s.setFieldsValue({introduce:(v=t==null?void 0:t.data)==null?void 0:v.introduce})}},[t]);const c=async()=>{await s.validateFields().then(async p=>{if(f.length&&b){const o=[b,...f];p.picture=JSON.stringify(o);const r=Qe(C);if(r.lang_ids=r.lang_ids.join(),r.server_ids=r.server_ids.join(),r.sales_cost.take_out.length===0&&delete r.sales_cost.take_out,r.sales_cost.eat_in.length===0&&delete r.sales_cost.eat_in,r.sales_cost=JSON.stringify(r.sales_cost),!(r!=null&&r.street))return P.show("\u8BF7\u91CD\u65B0\u9009\u62E9\u5730\u5740");O.fromAddress(r==null?void 0:r.street).then(async v=>{const{lat:B,lng:V}=v.results[0].geometry.location;p.latitude=`${B},${V}`,p=Fe(p,_e);let W;a?W=await ce.updateOnline({...p,...r}):W=await Z.extendEdit({...p,...r}),W.status===200&&(M.dispatch(te("")),k(a?"/personal/auth/online":"/calendar/plan"))},v=>{console.error(v)})}else P.show("\u8BF7\u4E0A\u4F20\u7167\u7247")})},x=p=>{const o=je(f,[f[p]],X);_([...o])};return I("div",{className:"flex h-full flex-col px-8 py-12 min-h-[100vh] overflow-auto",children:[e(d,{form:s,requiredMarkStyle:"none",children:e(d.Item,{name:"introduce",layout:"vertical",label:"\u4E2A\u4EBA\u4ECB\u7ECD",children:e(xe,{placeholder:"\u8BF7\u8F93\u5165",autoSize:{minRows:8,maxRows:8}})})}),I("div",{className:"flex justify-between items-center pt-8 pb-4",children:[e("p",{children:"\u5C01\u9762\u56FE"}),e("div",{onClick:()=>{if(g)return!1;L.current.click()},className:"text-xs bg-[#F3F3F3] font-500 rounded-2xl px-4 py-1",children:g?e(oe,{color:"primary"}):"\u4E0A\u4F20"}),e("input",{id:"file",type:"file",ref:L,accept:".jpg,.jpeg,.png",hidden:!0,onChange:p=>n(p)})]}),b&&e("img",{src:b,style:{borderRadius:10}}),I("div",{className:"flex justify-between items-center pt-8 pb-4",children:[e("p",{children:"\u7167\u7247&\u89C6\u9891"}),e("div",{onClick:()=>{if(u)return!1;A.current.click()},className:"text-xs bg-[#F3F3F3] font-500 rounded-2xl px-4 py-1",children:u?e(oe,{color:"primary"}):"\u4E0A\u4F20"}),e("input",{id:"file",type:"file",ref:A,accept:".jpg,.jpeg,.png,.mp4,.mkv,.avi,.mov,.wmv,.flv,.webm",hidden:!0,onChange:p=>E(p)})]}),e(Ue,{itemData:f,deleteImg:x}),e("div",{className:"flex justify-center mt-10",children:e(Q,{onClick:c,className:"w-[100%] h-[2.75rem]",block:!0,color:"primary",shape:"rounded",loadingIcon:e($e,{}),children:"\u4FDD\u5B58"})})]})};function Tt(l){const{langList:t}=l,[a]=d.useForm(),{data:s,loading:f}=q(()=>D.getInformationList({type:1}));return f?e(ee,{}):I("div",{className:"flex flex-col px-8 pt-20",children:[e("p",{className:"font-600 py-5 text-2xl",children:"\u7F16\u8F91\u8BE6\u7EC6\u8D44\u6599"}),I(ae,{gutter:24,children:[e(K,{span:12,children:e(d.Item,{label:"\u5E74\u9F84*",children:I("div",{className:`${S.input} flex items-center`,children:[e(d.Item,{noStyle:!0,name:"age",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5408\u6CD5\u5E74\u9F84",validator:(_,b,h)=>b<18?new Promise((u,F)=>{F("\u8BF7\u8F93\u5165\u5408\u6CD5\u5E74\u9F84")}):Promise.resolve()}],children:e(U,{placeholder:"\u5E74\u9F84"})}),e("p",{className:"text-xs pr-4 min-w-34px",children:"\u5C81"})]})})}),e(K,{span:12,children:e(d.Item,{label:"\u4F53\u91CD*",children:I("div",{className:`${S.input} flex items-center`,children:[e(d.Item,{noStyle:!0,name:"weight",rules:[{required:!0}],children:e(U,{placeholder:"\u4F53\u91CD"})}),e("p",{className:"text-xs pr-4 min-w-34px",children:"kg"})]})})})]}),I(ae,{gutter:24,children:[e(K,{span:12,children:e(d.Item,{label:"\u8EAB\u9AD8*",children:I("div",{className:`${S.input} flex items-center`,children:[e(d.Item,{noStyle:!0,name:"height",rules:[{required:!0}],children:e(U,{placeholder:"\u8EAB\u9AD8"})}),e("p",{className:"text-xs pr-4 min-w-34px",children:"cm"})]})})}),e(K,{span:12,children:e(d.Item,{label:"\u80F8\u56F4*",children:e("div",{className:`${S.input} flex items-center`,children:e(d.Item,{noStyle:!0,name:"chest",rules:[{required:!0}],children:e(U,{placeholder:"\u80F8\u56F4"})})})})})]}),I(ae,{gutter:24,children:[e(K,{span:12,children:e(d.Item,{name:"race",label:"\u4EBA\u79CD*",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4EBA\u79CD"}],className:S.raceContainer,children:e(me,{style:{width:"100%"},onChange:_=>{_&&a.setFieldsValue({race:[_]})},className:"!rounded-sm <sm:hidden",options:s==null?void 0:s.data})})}),e(K,{span:12,children:e(d.Item,{name:"lang_ids",label:"\u8BED\u8A00*",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BED\u8A00"}],className:S.raceContainer,children:e(me,{style:{width:"100%"},onChange:_=>{_&&a.setFieldsValue({lang_ids:_})},maxTagCount:"responsive",mode:"multiple",className:"!rounded-sm <sm:hidden",options:t==null?void 0:t.data})})})]})]})}function Ut(l){var A,L;const{eatInlist:t,setEatInlist:a,takeOutlist:s,setTakeOutlist:f,costUnit:_,setCostUnit:b,timePicker:h,extendData:u,swiperIndex:F,serviceList:g,value:w}=l,[C]=d.useForm(),k=M.getState().global.employeeForm;return m.exports.useEffect(()=>{var E,n,c,x,p;if(u!=null&&u.data){let o=u==null?void 0:u.data;console.log("formData",o),console.log((E=u==null?void 0:u.data)==null?void 0:E.basis.map(r=>r.id)),b("$"),k.sales_cost&&k.server_ids&&(o=k),o.sales_cost&&(((n=o.sales_cost.eat_in)==null?void 0:n.length)>0?a(o.sales_cost.eat_in):a([{}]),((c=o.sales_cost.take_out)==null?void 0:c.length)>0?f(o.sales_cost.take_out):f([{}])),o.cost&&(((x=o.cost.eat_in)==null?void 0:x.length)>0?a(o.cost.eat_in):a([{}]),((p=o.cost.take_out)==null?void 0:p.length)>0?f(o.cost.take_out):f([{}]))}},[F,u]),e("div",{className:"bg-[#fff] flex flex-col relative pt-10",children:I("div",{className:"flex flex-col px-4",children:[e("p",{className:"pb-4 py-12",children:"\u6536\u8D39\u6807\u51C6"}),_==="$"&&I(ee,{children:[e(d.Item,{className:`${S.dineIn} mt-4`,name:"eat_in",label:"\u5802\u98DF",children:e(ue,{form:C,timePicker:h,list:t,setList:a,keyTitle:"eat_in"})}),e(d.Item,{className:`${S.takeOut}`,name:"take_out",label:"\u5916\u5356",children:e(ue,{timePicker:h,list:s,setList:f,keyTitle:"take_out",form:C})}),e(d.Item,{name:"base_ids",label:"\u57FA\u7840\u670D\u52A1",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],className:`${S.raceContainer} pt-10`,children:e(me,{style:{width:"100%"},className:"!rounded-sm <sm:hidden",maxTagCount:"responsive",mode:"multiple",onChange:E=>{C.setFieldsValue({base_ids:E})},fieldNames:{label:"name",value:"id"},options:(A=g==null?void 0:g.data)==null?void 0:A.basis})}),e(d.Item,{name:"extra_ids",label:"\u989D\u5916\u670D\u52A1",className:`${S.raceContainer}`,children:e(me,{style:{width:"100%"},onChange:E=>{E&&C.setFieldsValue({extra_ids:E})},fieldNames:{label:"name",value:"id"},maxTagCount:"responsive",mode:"multiple",className:"!rounded-sm <sm:hidden",options:(L=g==null?void 0:g.data)==null?void 0:L.extra})})]})]})})}O.setApiKey(se);O.setLanguage("en");O.setRegion("es");O.setLocationType("ROOFTOP");const qt=l=>I("div",{className:"flex h-full flex-col px-8 pt-20",children:[e("p",{className:"text-lg pb-8 font-500",children:"\u5730\u5740\u4FE1\u606F"}),e(d.Item,{label:"\u8857\u9053*",children:e("div",{className:"flex items-center justify-between",children:e(d.Item,{noStyle:!0,name:"street",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u5730\u5740"}],children:e(Re,{})})})}),I(ae,{gutter:24,children:[e(K,{span:12,children:e(d.Item,{label:"\u95E8\u724C\u53F7",children:e("div",{className:`${S.input} flex items-center`,children:e(d.Item,{noStyle:!0,name:"house_num",children:e(U,{placeholder:"\u95E8\u724C\u53F7"})})})})}),e(K,{span:12,children:e(d.Item,{label:"\u6309\u94C3\u65B9\u5F0F",children:e("div",{className:`${S.input} flex items-center`,children:e(d.Item,{noStyle:!0,name:"bell",children:e(U,{placeholder:"\u6309\u94C3\u65B9\u5F0F"})})})})})]})]});O.setApiKey(se);O.setLanguage("en");O.setRegion("es");O.setLocationType("ROOFTOP");const Mt=l=>{const{extendData:t,images:a,setImages:s,coverImg:f,setCoverImg:_,isUserOnline:b}=l,[h]=d.useForm(),[u,F]=m.exports.useState(!1),[g,w]=m.exports.useState(!1);M.getState().global.employeeForm,pe();const C=m.exports.useRef(null),k=m.exports.useRef(null),A=async n=>{const c=[...n.target.files];if(c.length){F(!0);const x=await de.uploadFile(c);(x==null?void 0:x.status)===200&&(P.show(x.data.msg),s(()=>{var p,o;return[...a,(o=(p=x==null?void 0:x.data)==null?void 0:p.data)==null?void 0:o.file_url]})),F(!1)}},L=async n=>{var x,p;const c=[...n.target.files];if(c.length){w(!0);const o=await de.uploadFile(c);(o==null?void 0:o.status)===200&&(P.show(o.data.msg),_((p=(x=o==null?void 0:o.data)==null?void 0:x.data)==null?void 0:p.file_url)),w(!1)}};m.exports.useEffect(()=>{var n,c,x,p;if(t!=null&&t.data){if(b){const o=[];(x=(c=t==null?void 0:t.data)==null?void 0:c.picture)==null||x.map((r,v)=>{v>0?o.push(r):_(r)}),s(o)}else{const o=[];(n=t==null?void 0:t.data)==null||n.picture.map((r,v)=>{v>0?o.push(r.url):_(r.url)}),s(o)}h.setFieldsValue({introduce:(p=t==null?void 0:t.data)==null?void 0:p.introduce})}},[t]);const E=n=>{const c=je(a,[a[n]],X);s([...c])};return I("div",{className:"flex h-full flex-col px-8 py-12 overflow-auto",children:[e(d.Item,{name:"introduce",layout:"vertical",label:"\u4E2A\u4EBA\u4ECB\u7ECD",children:e(xe,{placeholder:"\u8BF7\u8F93\u5165",autoSize:{minRows:8,maxRows:8}})}),I("div",{className:"flex justify-between items-center pt-8 pb-4",children:[e("p",{children:"\u5C01\u9762\u56FE"}),e("div",{onClick:()=>{if(g)return!1;k.current.click()},className:"text-xs bg-[#F3F3F3] font-500 rounded-2xl px-4 py-1 cursor-pointer",children:g?e(oe,{color:"primary"}):"\u4E0A\u4F20"}),e("input",{id:"file",type:"file",ref:k,accept:".jpg,.jpeg,.png",hidden:!0,onChange:n=>L(n)})]}),f&&e("img",{src:f,style:{borderRadius:10,width:300}}),I("div",{className:"flex justify-between items-center pt-8 pb-4",children:[e("p",{children:"\u7167\u7247&\u89C6\u9891"}),e("div",{onClick:()=>{if(u)return!1;C.current.click()},className:"text-xs bg-[#F3F3F3] font-500 cursor-pointer rounded-2xl px-4 py-1",children:u?e(oe,{color:"primary"}):"\u4E0A\u4F20"}),e("input",{id:"file",type:"file",ref:C,accept:".jpg,.jpeg,.png,.mp4,.mkv,.avi,.mov,.wmv,.flv,.webm",hidden:!0,onChange:n=>A(n)})]}),e(Ue,{itemData:a,deleteImg:E})]})};O.setApiKey(se);O.setLanguage("en");O.setRegion("es");O.setLocationType("ROOFTOP");function Vt(){const l=pe(),t=Oe(),a=m.exports.useRef(null),[s]=d.useForm();Pe(document.querySelector("body"));const[f,_]=m.exports.useState([]),[b,h]=m.exports.useState([]),[u,F]=m.exports.useState({}),[g,w]=m.exports.useState(!1),[C,k]=m.exports.useState(),[A,L]=m.exports.useState(),[E,n]=m.exports.useState("%"),[c,x]=m.exports.useState([]),[p,o]=m.exports.useState(""),{run:r,data:v,loading:B}=q(()=>D.getInformationList({type:2}),{manual:!0}),{run:V}=q(()=>D.getInformationList({type:9}),{onSuccess(i){h(i==null?void 0:i.data)},manual:!0}),{run:W,data:he,loading:H}=q(Z.getServerList,{onSuccess(i){var z,Y;const R=[],N=[];(z=i.data)==null||z.basis.map($=>R.push($.id)),(Y=i.data)==null||Y.extra.map($=>N.push($.id)),_([...R,...N])},manual:!0}),{run:ie,loading:ne}=q(()=>{var i;return Z.extendStaff({id:(i=t==null?void 0:t.state)==null?void 0:i.id})},{manual:!0,onSuccess(i){F(i)}}),{run:y}=q(()=>ce.onlineUserInfo({}),{manual:!0,onSuccess(i){F(i),w(!0)}});m.exports.useEffect(()=>{var i,R;r(),V(),W(),(i=t==null?void 0:t.state)!=null&&i.id&&ie(),(R=t==null?void 0:t.state)!=null&&R.onlineUser&&y()},[]),m.exports.useEffect(()=>{var i,R;if(u!=null&&u.data){const{data:N}=u,z=N.lang_ids.map(j=>Number(j));console.log("-=-=-",N);const Y=(i=N==null?void 0:N.basis)==null?void 0:i.map(j=>j.id),$=(R=N==null?void 0:N.extra)==null?void 0:R.map(j=>j.id);s.setFieldsValue({age:N.age,weight:N.weight,height:N.height,chest:N.chest,lang_ids:z,race:N.race,base_ids:Y,extra_ids:$,street:N.street||N.address||"",house_num:N.house_num,bell:N.bell,remark:N.remark,introduce:N.introduce})}},[u]);const T=i=>{var z,Y;console.log(i);const R=[];if(C){let $={};Object.keys(C).map(j=>{$={price:i.eat_in[`price_${j}`],time:i.eat_in[`time_${j}`][0]},R.push($)})}const N=[];if(A){let $={};Object.keys(A).map(j=>{$={price:i.take_out[`price_${j}`],time:i.take_out[`time_${j}`][0]},N.push($)})}if(i.sales_cost={eat_in:le(R,[{time:void 0,price:void 0},{time:"",price:""}],X),take_out:le(N,[{time:void 0,price:void 0},{time:"",price:""}],X)},!i.sales_cost.eat_in.length&&!i.sales_cost.take_out.length)return P.show("\u5916\u5356/\u5802\u98DF\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A");if(i.sales_cost.eat_in.length&&i.sales_cost.eat_in.map($=>{if(!$.price||!$.time)throw P.show("\u8BF7\u5B8C\u5584\u6216\u6E05\u7A7A")}),i.sales_cost.take_out.length&&i.sales_cost.take_out.map($=>{if(!$.price||!$.time)throw P.show("\u8BF7\u5B8C\u5584\u6216\u6E05\u7A7A")}),delete i.take_out,delete i.eat_in,c.length&&p){const $=[p,...c];if(i.picture=JSON.stringify($),i.lang_ids=i.lang_ids.join(),i.server_ids=[...i.base_ids,...i==null?void 0:i.extra_ids].join(),delete i.base_ids,delete i.extra_ids,i.sales_cost.take_out.length===0&&delete i.sales_cost.take_out,i.sales_cost.eat_in.length===0&&delete i.sales_cost.eat_in,i.sales_cost=JSON.stringify(i.sales_cost),i.nickname=(z=u==null?void 0:u.data)==null?void 0:z.nickname,i.id=(Y=u==null?void 0:u.data)==null?void 0:Y.id,!(i!=null&&i.street))return P.show("\u8BF7\u91CD\u65B0\u9009\u62E9\u5730\u5740");O.fromAddress(i==null?void 0:i.street).then(async j=>{var ye,Ie;console.log("come in ");const{lat:qe,lng:Me}=j.results[0].geometry.location;i.latitude=`${qe},${Me}`,i=Fe(i,_e);let re;(ye=t==null?void 0:t.state)!=null&&ye.onlineUser?re=await ce.updateOnline({...i}):re=await Z.extendEdit({...i}),re.status===200?(M.dispatch(te("")),(Ie=t==null?void 0:t.state)!=null&&Ie.onlineUser?l("/personal/auth/online"):l("/calendar/plan")):P.show(re.msg)},j=>{P.show("ZERO_RESULTS")})}else P.show("\u8BF7\u4E0A\u4F20\u7167\u7247")};return H||B||ne?e(Le,{}):I("div",{className:`${S.AddEmployeeForm} !min-h-auto bg-[#fff] !w-500px`,children:[I(d,{form:s,requiredMarkStyle:"none",layout:"horizontal",onFinish:T,footer:null,children:[e(Tt,{langList:v,extendData:u}),e(Ut,{eatInlist:C,setEatInlist:k,extendData:u,takeOutlist:A,setTakeOutlist:L,costUnit:E,setCostUnit:n,value:f,serviceList:he,swipeNext:()=>{var i;return(i=a.current)==null?void 0:i.swipeNext()},timePicker:b,setTimePicker:h}),e(qt,{extendData:u}),e(Mt,{images:c,setImages:x,coverImg:p,setCoverImg:o,isUserOnline:g,extendData:u}),e(Q,{color:"primary",shape:"rounded",className:"mb-10 w-100px",type:"submit",children:"\u786E\u5B9A"})]}),e("div",{onClick:()=>l(-1),className:"fixed top-80px right-40px",children:e(Ge,{fontSize:24,className:"cursor-pointer"})})]})}function Rs(){var ie,ne;const l=pe(),t=Oe(),a=m.exports.useRef(null),s=Pe(document.querySelector("body")),[f,_]=m.exports.useState(0),[b,h]=m.exports.useState([]),[u,F]=m.exports.useState([]),[g,w]=m.exports.useState({}),[C,k]=m.exports.useState(!1),[A,L]=m.exports.useState([]),[E,n]=m.exports.useState([]),{run:c,data:x,loading:p}=q(()=>D.getInformationList({type:2}),{manual:!0}),{run:o}=q(()=>D.getInformationList({type:9}),{manual:!0,onSuccess(y){F(y==null?void 0:y.data)}}),{data:r,loading:v,run:B}=q(Z.getServerList,{manual:!0,onSuccess(y){var T,i;L((T=y.data)==null?void 0:T.basis),n((i=y.data)==null?void 0:i.extra)}}),{run:V,loading:W}=q(()=>{var y;return Z.extendStaff({id:(y=t==null?void 0:t.state)==null?void 0:y.id})},{manual:!0,onSuccess(y){w(y)}}),{run:he}=q(()=>ce.onlineUserInfo({}),{manual:!0,onSuccess(y){var R,N;console.log("res-",y);const T=[],i=[];(R=y.data)==null||R.basis.map(z=>T.push(z.id)),(N=y.data)==null||N.extra.map(z=>i.push(z.id)),h([...T,...i]),w(y),k(!0)}});m.exports.useEffect(()=>{var y,T;(s==null?void 0:s.width)&&(s==null?void 0:s.width)<=640&&(c(),o(),B(),(y=t==null?void 0:t.state)!=null&&y.id&&V(),(T=t==null?void 0:t.state)!=null&&T.onlineUser&&he())},[s==null?void 0:s.width]),m.exports.useEffect(()=>{var y,T,i,R;!v&&g&&((y=g==null?void 0:g.data)==null?void 0:y.server_ids)&&h((T=g==null?void 0:g.data)==null?void 0:T.server_ids),!v&&((i=t==null?void 0:t.state)==null?void 0:i.type)&&((R=a.current)==null||R.swipeTo(2))},[g,v]);const H=()=>{var y;(y=a.current)==null||y.swipeNext()};return v||p||W?e(Le,{}):I(ee,{children:[(s==null?void 0:s.width)&&(s==null?void 0:s.width)<=640&&I("div",{className:`${S.AddEmployeeForm} bg-[#fff] sm:hidden`,children:[e(Ke,{onBack:()=>{var y;f===0&&(M.dispatch(te("")),l(-1)),(y=a.current)==null||y.swipeTo(f-1)},renderRight:!1,title:"\u7F16\u8F91\u8BE6\u7EC6\u8D44\u6599",border:!0}),I(J,{ref:a,onIndexChange:y=>{_(y)},style:{"--height":"100vh"},defaultIndex:f,loop:!1,allowTouchMove:!1,indicator:()=>null,children:[e(J.Item,{children:e(lt,{langList:x,swiperIndex:f,extendData:g,next:H,nickname:(ie=g==null?void 0:g.data)==null?void 0:ie.nickname})}),e(J.Item,{style:{overflowY:"auto",paddingBottom:120},children:f===1&&e(ut,{extendData:g,swiperIndex:f,next:H,value:b,serviceList:r,swipeNext:()=>{var y;return(y=a.current)==null?void 0:y.swipeNext()},timePicker:u,setTimePicker:F})}),e(J.Item,{style:{overflowY:"auto",paddingBottom:90},children:e(Xe,{swiperIndex:f,extendData:g,value:b,setValue:h,basisOptions:A,extraOptions:E,serviceList:r,next:H,id:(ne=t==null?void 0:t.state)==null?void 0:ne.id})}),e(J.Item,{children:e(ct,{swiperIndex:f,extendData:g,next:H})}),e(J.Item,{style:{overflowY:"auto",paddingBottom:90},children:e(jt,{isUserOnline:C,extendData:g})})]})]}),(s==null?void 0:s.width)&&(s==null?void 0:s.width)>640&&e(Vt,{})]})}export{Rs as default};
