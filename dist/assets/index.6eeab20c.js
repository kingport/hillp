import{u as g,s as _,k as i,a as N,j as l,b as t,B as E,W as F,T as v}from"./index.5670e6e0.js";import{E as D}from"./index.1c39e7a0.js";import{H as b}from"./index.04556cd2.js";import{P as o}from"./pay.4a84b5b1.js";import{L as j}from"./line-left.42f098a5.js";/* empty css                    *//* empty css                 */const $=()=>{var r;const m=g(),p=_.getState().global.payInfo,{type:e,stripeInfo:a}=p,{data:n,run:y}=i(()=>o.getStripeInfo({type:4}),{manual:!0});N(()=>{e===4&&y()});let c="";(a==null?void 0:a.setmeal_level)===1&&(c="\u5B63\u5EA6"),(a==null?void 0:a.setmeal_level)===2&&(c="\u5E74"),(a==null?void 0:a.setmeal_level)===3&&(c="\u6708");let u={};e===1&&(u={type:e,setmeal_id:a==null?void 0:a.setmeal_id,success_url:window.location.origin+"/pay/success?url=/personal/auth/online",cancel_url:window.location.origin+"/pay/faild?url=/personal/auth/online"}),e===2&&(u={type:e,setmeal_id:a==null?void 0:a.setmeal_id,success_url:window.location.origin+"/pay/success?url=/personal/auth/association",cancel_url:window.location.origin+"/pay/faild?url=/personal/auth/association"}),e===3&&(u={type:e,num:a==null?void 0:a.num,success_url:window.location.origin+"/pay/success?url=/personal/auth/sign",cancel_url:window.location.origin+"/pay/faild?url=/personal/auth/sign"}),e===4&&(u={type:e,staff_id:a==null?void 0:a.staff_id,success_url:window.location.origin+"/pay/success?url=/calendar",cancel_url:window.location.origin+"/pay/faild?url=/calendar"});const{runAsync:w}=i(()=>o.payCheck(u),{manual:!0,onSuccess(s){(s.status===200||s.status===201)&&x()}}),{run:x}=i(()=>o.pay(u),{manual:!0,onSuccess(s){var d,f;((d=s==null?void 0:s.data)==null?void 0:d.is_pay)===2?v.show({content:"\u65E0\u9700\u652F\u4ED8\uFF0C\u5EF6\u8FDF5\u79D2\u5237\u65B0\u6570\u636E",afterClose(){m("/personal/wallet")}}):window.location.href=(f=s==null?void 0:s.data)==null?void 0:f.url}}),h=async()=>{await w()};return l("div",{className:"flex flex-col justify-center items-center <sm:min-h-[100vh] sm:w-400px",children:[t(b,{title:"\u786E\u8BA4\u4FE1\u606F",renderRight:!1}),l("div",{className:"flex w-[80%] flex-col bg-[#f8f8f8] rounded-xl sm:w-full",children:[e===3&&l("div",{className:"flex items-center justify-between px-5.5 py-8.5",children:[t("p",{className:"text-sm font-600",children:"\u53EF\u53D1\u5E03\u4FE1\u606F\u4F59\u989D\u5145\u503C"}),l("p",{className:"text-sm",children:["$",a==null?void 0:a.amount,"x",a==null?void 0:a.num]})]}),(e===2||e===1)&&l("div",{className:"flex items-center justify-between px-5.5 py-8.5",children:[l("div",{className:"flex flex-col",children:[t("p",{className:"text-sm font-600",children:a.name}),t("p",{className:"text-xs text-color-[#666]",children:a.remark})]}),l("p",{className:"text-sm",children:["$",a==null?void 0:a.amount,"/",c]})]}),e===4&&l("div",{className:"flex items-center justify-between px-5.5 py-8.5",children:[t("p",{className:"text-sm font-600",children:"\u5E73\u53F0\u4F63\u91D1"}),l("p",{className:"text-sm",children:["$",(r=n==null?void 0:n.data)==null?void 0:r.amount]})]})]}),t(E,{onClick:h,className:"mt-4 w-[70%] sm:w-full",color:"primary",block:!0,loading:"auto",loadingIcon:t(D,{}),children:"\u786E\u8BA4\u652F\u4ED8"}),l("div",{onClick:()=>m(-1),className:"flex items-center cursor-pointer items-center <sm:hidden font-600 fixed top-30 left-40",children:[t(F,{src:j,className:"mr-4 w-30px"}),"\u8FD4\u56DE"]})]})};export{$ as default};
