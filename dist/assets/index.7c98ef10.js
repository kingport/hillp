import{ct as et,cu as tt,bA as rt,bB as at,bv as lt,bC as nt,bu as it,bE as st,co as Ke,u as Ge,i as We,k as C,aF as S,r as h,b as t,j as r,S as y,a1 as Pe,a0 as o,F as N,an as c,b$ as dt,B as s}from"./index.5670e6e0.js";import{D as Ue}from"./index.1dc54ea5.js";import{F as Ee}from"./index.11c9b67d.js";import{I as ct}from"./index.66fe089c.js";import{P as ut}from"./index.77a6b2f7.js";import{R as F,a as Qe}from"./index.30722385.js";import{S as Xe}from"./Skeleton.c599669d.js";import{u as ot}from"./index.5733fb44.js";import{H as mt}from"./index.04556cd2.js";import{H as pt}from"./index.9fe94518.js";import{G as _,I as Ze}from"./init.01b19658.js";import{P as ft}from"./PickerContent.7accd0df.js";import{I as De}from"./information.c9048f81.js";import{s as xt}from"./index.module.b0898225.js";import{D as g,S as I}from"./dropdown.706ec38f.js";import{I as ht}from"./index.0edfa0b7.js";import{F as ge}from"./index.fcc496e2.js";import{M as yt}from"./index.c5e480b2.js";import{S as Nt}from"./index.0a2bddee.js";import{D as j}from"./DownOutlined.9a14fa90.js";/* empty css                    *//* empty css                 */import"./dayjs.min.37299693.js";import"./isoWeek.f8ad8697.js";import"./bound.bddb6539.js";import"./is-node-with-content.f661b98b.js";import"./interopRequireDefault.fc5525a1.js";import"./dev-log.6e115cc9.js";import"./index.31244c45.js";import"./index.cb878f88.js";import"./convert-px.daab3cc2.js";import"./CloseCircleFill.55d4b485.js";import"./index.c6660251.js";import"./use-gesture-react.esm.346ddc85.js";import"./rubberband.c88fa690.js";import"./index.9bb4ee10.js";import"./index.af3e2847.js";import"./index.1c39e7a0.js";import"./PurePanel.2a417db7.js";import"./index.42a6e0fb.js";import"./index.92e459fd.js";import"./collapse.e34cf270.js";import"./useFlexGapSupport.172cfcf4.js";import"./index.a450b78e.js";import"./statusUtils.6dc02607.js";import"./SearchOutlined.a0283b8c.js";import"./row.06620ecf.js";var vt=et,wt=tt,Ft=rt,kt=at,At=lt,Ct=nt.exports,_t=it,Bt=st,Et="[object Map]",gt="[object Set]",It=Object.prototype,jt=It.hasOwnProperty;function St(i){if(i==null)return!0;if(At(i)&&(kt(i)||typeof i=="string"||typeof i.splice=="function"||Ct(i)||Bt(i)||Ft(i)))return!i.length;var v=wt(i);if(v==Et||v==gt)return!i.size;if(_t(i))return!vt(i).length;for(var f in i)if(jt.call(i,f))return!1;return!0}var k=St;const Ot="_CalendarView_130yx_1",$t="_BorderedViewItem_130yx_6",Tt="_Avatar_130yx_14",Pt="_earnestInput_130yx_41",Vt="_PcearnestInput_130yx_52",x={CalendarView:Ot,BorderedViewItem:$t,Avatar:Tt,earnestInput:Pt,PcearnestInput:Vt};_.setApiKey(Ke);_.setLanguage("en");_.setRegion("es");_.setLocationType("ROOFTOP");function Mt(){var P,Te,V,M,L,Y,H,z,R,q,J,K,G,W,U,Q,X,Z,D,b,ee,te,re,ae,le,ne,ie,se,de,ce,ue,oe,me,pe,fe,xe,he,ye,Ne,ve,we,Fe,ke,Ae,Ce,_e;const i=Ge(),v=We(),f=(P=v==null?void 0:v.state)==null?void 0:P.id,[Ie]=ge.useForm(),{data:e,loading:Ve,refresh:B}=C(S.getSubscribeDetail,{defaultParams:[{id:Number(f)}]}),{runAsync:Me}=C(S.editOrder,{manual:!0});C(()=>De.getInformationList({type:3}),{onSuccess(a){Ye(a==null?void 0:a.data)}});const{run:O}=C(a=>S.editOrder(a),{manual:!0,onSuccess(a){B(),p(!1)}}),[Le,Ye]=h.exports.useState([]),[je,He]=h.exports.useState(0),[ze,p]=h.exports.useState(!1),[$,A]=h.exports.useState("");h.exports.useState(""),h.exports.useEffect(()=>{e&&e.data&&He(e.data.status)},[e]);const m=async(a,l,n)=>{(await Me({source:a,params:JSON.stringify(l),id:f})).status===200&&(B(),n&&n())},Se=()=>{var a,l;if(e.data.source===2)return!1;i("/manage/customer/info",{state:{id:(a=e==null?void 0:e.data)==null?void 0:a.client_id,from:"calendarView",source:(l=e==null?void 0:e.data)==null?void 0:l.source}})},u=()=>{i("/calendar/pay",{state:{payInfo:e==null?void 0:e.data}})},Re=()=>{A("earnest"),p(!0)},w=()=>{A("address"),p(!0)},qe=a=>{$==="earnest"?O({id:f,source:2,params:JSON.stringify({information_id:a.information_id,earnest:a.earnest})}):$==="address"&&O({id:f,source:4,params:JSON.stringify({address:a.address})})},Oe=()=>{var l;return o(((l=e==null?void 0:e.data)==null?void 0:l.start_time)*1e3).add(-15,"minutes").isBefore(o())},T=()=>{var l,n;return o(((l=e==null?void 0:e.data)==null?void 0:l.start_time)*1e3).add((n=e==null?void 0:e.data)==null?void 0:n.duration,"minutes").isBefore(o())},Je=async a=>{if((a==null?void 0:a.key)==="edit"&&i(`/calendar/edit/order/${f}`,{state:{customerId:e.data.client_id}}),(a==null?void 0:a.key)==="rearrange"&&i(`/calendar/edit/order/${f}`,{state:{customerId:e.data.client_id}}),(a==null?void 0:a.key)==="cancel"&&m(9,{},()=>{i("/calendar")}),(a==null?void 0:a.key)==="edit_time"){const l=await Ue.prompt({precision:"minute"});l&&m(3,{start_time:o(l).unix()},()=>{i("/calendar")})}(a==null?void 0:a.key)==="edit_address"&&w()},$e=()=>{let a=[];const{status:l,source:n,server_type:d,push_house:Be,staff_evaluate:be}=e.data;l===0||n===1?a=[{label:"\u7F16\u8F91\u9884\u7EA6",key:"edit"},{label:"\u91CD\u65B0\u6392\u671F",key:"rearrange"},{label:"\u53D6\u6D88\u9884\u7EA6",key:"cancel",danger:!0}]:(l===1&&d===2&&n===2||l===1&&d===1&&n===2)&&(a=[{label:"\u66F4\u6539\u65F6\u95F4",key:"edit_time"},{label:"\u66F4\u6539\u5730\u5740",key:"edit_address",disabled:!(d===1&&n===2)}]);const E={items:a,onClick:Je};return l===0&&n===2&&d===1?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(c,{className:"w-[35%] mr-4",block:!0,onClick:()=>{m(1,{},()=>{i("/calendar")})},children:"\u62D2\u7EDD\u63A5\u5355"}),t(c,{className:"w-[35%]",type:"primary",block:!0,onClick:()=>{m(7,{})},children:"\u63A5\u53D7\u8BA2\u5355"})]}):l===0&&n===1&&d===1?t(N,{}):l===0&&n===1&&d===2?t(N,{}):l===0&&n===2&&d===2?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(c,{style:{width:"48%"},onClick:()=>{m(1,{},()=>{i("/calendar")})},children:"\u62D2\u7EDD\u63A5\u5355"}),t(c,{style:{width:"48%"},type:"primary",onClick:()=>{m(7,{})},children:"\u63A5\u53D7\u8BA2\u5355"})]}):l===1&&d===1&&n===2?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(c,{style:{width:"48%"},type:"primary",danger:!0,onClick:()=>{m(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(g,{menu:E,children:t(c,{style:{width:"48%"},children:r(I,{children:["\u66F4\u591A",t(j,{})]})})})]}):l===1&&d===1&&n===1?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(g,{menu:E,children:t(c,{style:{width:"48%"},children:r(I,{children:["\u66F4\u591A",t(j,{})]})})}),t(c,{style:{width:"48%"},type:"primary",onClick:u,children:"\u7ED3\u4ED8"})]}):l===1&&d===2&&n===2&&!Oe()?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(c,{style:{width:"48%"},type:"primary",danger:!0,onClick:()=>{m(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(g,{menu:E,children:t(c,{style:{width:"48%"},children:r(I,{children:["\u66F4\u591A",t(j,{})]})})})]}):l===1&&d===2&&n===2&&Oe()?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(c,{style:{width:"48%"},type:"primary",danger:!0,onClick:()=>{m(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(c,{style:{width:"48%"},type:"primary",onClick:()=>{m(5,{})},children:"\u5458\u5DE5\u5DF2\u5230\u8FBE"})]}):l===1&&d===2&&n===1?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(g,{menu:E,children:t(c,{style:{width:"48%"},children:r(I,{children:["\u66F4\u591A",t(j,{})]})})}),t(c,{style:{width:"48%"},type:"primary",onClick:u,children:"\u7ED3\u4ED8"})]}):l===4&&d===1&&n===2&&!T()&&Be!==1?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(c,{style:{width:"48%"},type:"primary",danger:!0,onClick:()=>{m(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(c,{style:{width:"48%"},type:"primary",onClick:()=>{m(8,{})},children:"\u53D1\u9001\u623F\u95F4\u53F7"})]}):l===4&&d===1&&n===2&&T()&&Be!==1?t("div",{className:"flex justify-between w-[80%] pt-4",children:t(c,{style:{width:"100%"},type:"primary",onClick:u,children:"\u7ED3\u4ED8"})}):l===4&&d===1&&n===2&&Be===1?t("div",{className:"flex justify-between w-[80%] pt-4",children:t(c,{style:{width:"100%"},type:"primary",onClick:u,children:"\u7ED3\u4ED8"})}):l===4&&d===1&&n===1?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(g,{menu:E,children:t(c,{style:{width:"48%"},children:r(I,{children:["\u66F4\u591A",t(j,{})]})})}),t(c,{style:{width:"48%"},type:"primary",onClick:u,children:"\u7ED3\u4ED8"})]}):l===4&&d===2&&n===2?t("div",{className:"flex justify-between w-[80%] pt-4",children:t(c,{style:{width:"100%"},type:"primary",onClick:u,children:"\u7ED3\u4ED8"})}):l===4&&d===2&&n===1?r("div",{className:"flex justify-between w-[80%] pt-4",children:[t(g,{menu:E,children:t(c,{style:{width:"48%"},children:r(I,{children:["\u66F4\u591A",t(j,{})]})})}),t(c,{style:{width:"48%"},type:"primary",onClick:u,children:"\u7ED3\u4ED8"})]}):[2,3,6,7].includes(l)?t(N,{}):l==5&&be===0&&n!==1?t("div",{className:"w-full flex justify-center mt-4",children:t(Qe,{name:e.data.client_name,id:e.data.id,width:"70%",callback:B})}):t(N,{})};return Ve||!e.data?t(Xe,{loading:!0}):r("div",{className:`${x.CalendarView}`,children:[r("div",{className:"text-xl flex z-99 items-center justify-between fixed top-0 bg-[#fff] font-600 py-10 border-b-width-1px text-center border-solid border-color-[#e7eaea] w-full",children:[t("p",{}),t("p",{children:"\u9884\u7EA6\u8BE6\u60C5"}),t(y,{name:"nav-cancel",onClick:()=>i("/calendar"),className:"w-[20px] h-[20px] mr-4 cursor-pointer"})]}),r("div",{className:"flex pt-25 h-[100vh]",children:[t("div",{className:"flex flex-1 flex-col px-10 py-12 justify-center items-center",children:r("div",{className:"w-[500px]",children:[r("span",{className:"text-2xl font-600",children:[Pe(((Te=e==null?void 0:e.data)==null?void 0:Te.start_time)*1e3),"\xA0",o(((V=e==null?void 0:e.data)==null?void 0:V.start_time)*1e3).format("YYYY\u5E74MM\u6708DD\u65E5")]}),r("div",{className:`${x.BorderedViewItem} flex flex-col mt-12`,children:[r("span",{className:"text-base font-600",children:[e.data.online_name||"--",o(((M=e==null?void 0:e.data)==null?void 0:M.start_time)*1e3).format("HH:mm")]}),r("span",{className:"text-xs",children:[e.data.server_type===1?"\u5802\u98DF":"\u5916\u5356"," \uFF0C\u4E0E",e.data.staff_name||"--",e.data.duration,"\u5206\u949F\u7684\u9884\u7EA6"]})]}),r("div",{className:`${x.BorderedViewItem} flex flex-col leading-7 `,children:[r("div",{className:"flex justify-between",children:[r("div",{className:"text-xs",children:[t("span",{className:"font-600",children:"\u57FA\u7840\u670D\u52A1\uFF1A"}),t("span",{children:e.data.basics_server})]}),r("span",{children:["$",e.data.basics_price]})]}),e.data.extra_ids.length>0?r("div",{className:"flex justify-between",children:[r("div",{className:"text-xs",children:[t("span",{className:"font-600",children:"\u989D\u5916\u670D\u52A1\uFF1A"}),t("span",{children:e.data.extra_server})]}),r("span",{children:["$",e.data.extra_price]})]}):null,r("div",{className:"flex justify-between",children:[t("div",{className:"text-xs",children:r("span",{className:"font-600 flex items-center",children:["\u5B9A\u91D1",((L=e==null?void 0:e.data)==null?void 0:L.source)===1&&t(y,{onClick:Re,name:"edit",className:"w-[20px] h-16px cursor-pointer"})]})}),r("span",{children:["$",e.data.earnest]})]})]}),r("div",{className:`${x.BorderedViewItem} flex flex-col pb-3`,children:[r("div",{style:{borderBottom:"0.5px solid #a1a1a1"},className:"flex justify-between text-lg text-color-[#2A4948] font-600 pb-4",children:[r("span",{children:[e.data.duration/60,"hr"]}),r("span",{children:["$",e.data.total_amount]})]}),r("div",{className:"flex flex-wrap items-center text-xs pt-5 pb-2",children:[t("span",{className:"text-color-[#464646] font-600",children:"\u5BA2\u6237\u8054\u7CFB\u65B9\u5F0F\uFF1A"}),r("span",{className:"text-color-[#858585]",children:[e.data.client_area||"--"," ",e.data.client_phone]})]}),r("div",{className:"flex flex-wrap items-center text-xs pb-2",children:[t("span",{className:"text-color-[#464646] font-600",children:"\u5730\u5740\uFF1A"}),t("span",{className:"text-color-[#858585]",children:e.data.address}),t(y,{name:"edit",className:"w-[16px] h-[16px] ml-1 fill-[#2A4948] cursor-pointer",onClick:w})]}),r("div",{className:"flex flex-wrap items-center text-xs",children:[t("span",{className:"text-color-[#464646] font-600",children:"\u5907\u6CE8\uFF1A"}),t("span",{className:"text-color-[#858585]",children:e.data.remark})]})]}),r("div",{className:"flex flex-col text-xs pb-2 pt-4",children:[t("p",{className:"text-color-[#464646] font-600",children:"\u8BA2\u5355\u8BE6\u60C5\uFF1A"}),r("span",{className:"text-xs text-color-[#B7B7B7] mb-6 pt-2",children:["\u8BA2\u5355\u53F7#",e.data.order_no," ",o(((Y=e==null?void 0:e.data)==null?void 0:Y.start_time)*1e3).format("YYYY\u5E74MM\u6708DD\u65E5")," ",Pe(((H=e==null?void 0:e.data)==null?void 0:H.start_time)*1e3),"\xA0",o(((z=e==null?void 0:e.data)==null?void 0:z.start_time)*1e3).format("HH:mm")]})]})]})}),r("div",{className:"w-262px flex flex-col justify-between items-center border border-solid border-r-0 border-t-0 border-b-0 border-color-[#e7eaea]",children:[t("div",{children:e.data.client_name&&t("div",{className:`${x.BorderedViewItem} flex justify-center mt-15`,onClick:Se,children:r("div",{className:"flex flex-col justify-center items-center",children:[t("div",{className:`${x.Avatar} flex items-center cursor-pointer justify-center`,children:e.data.client_head?t("img",{src:e.data.client_head}):t("div",{children:e.data.client_name[0].toUpperCase()})}),r("div",{className:"flex flex-col items-center justify-center",children:[r("div",{className:"flex w-200px items-center text-sm pt-2",children:[t("span",{className:"font-600",children:"\u90AE\u7BB1\uFF1A"}),t("span",{children:(R=e==null?void 0:e.data)==null?void 0:R.client_email})]}),r("div",{className:"flex w-200px items-center text-sm py-2",children:[t("span",{className:"font-600",children:"\u624B\u673A\uFF1A"}),r("span",{children:[(q=e==null?void 0:e.data)==null?void 0:q.client_area," ",(J=e==null?void 0:e.data)==null?void 0:J.client_phone]})]}),r("div",{className:"flex w-200px text-sm",children:[t("span",{className:"font-600 w-42px",children:"\u5907\u6CE8\uFF1A"}),t("span",{className:"flex-1",children:((K=e==null?void 0:e.data)==null?void 0:K.client_remark)||"--"})]}),!k((G=e==null?void 0:e.data)==null?void 0:G.evaluate)&&((W=e==null?void 0:e.data)==null?void 0:W.source)!==1&&r("div",{className:"flex flex-col pt-10",children:[r("div",{className:"flex flex-col",children:[t("p",{className:"font-600 pb-3",children:"\u5BA2\u6237\u8BC4\u4EF7"}),r("div",{className:"flex items-center",children:[t(F,{style:{"--star-size":"14px"},readOnly:!0,value:(X=(Q=(U=e==null?void 0:e.data)==null?void 0:U.evaluate)==null?void 0:Q.client)==null?void 0:X.score}),k((D=(Z=e==null?void 0:e.data)==null?void 0:Z.evaluate)==null?void 0:D.client)?t("p",{className:"text-xs pl-2 text-color-[#000]",children:"\u6682\u672A\u8BC4\u5206"}):r("p",{className:"text-xs pl-2 text-color-[#000]",children:["\u7EFC\u5408\u8BC4\u5206\uFF1A",(te=(ee=(b=e==null?void 0:e.data)==null?void 0:b.evaluate)==null?void 0:ee.client)==null?void 0:te.score]})]}),!k((ae=(re=e==null?void 0:e.data)==null?void 0:re.evaluate)==null?void 0:ae.client)&&r("div",{className:"flex flex-col py-4",children:[t("p",{className:"text-sm text-color-[#000] pb-1",children:"\u8BC4\u5206\u6807\u51C6"}),r("div",{className:"flex items-center",children:[t("p",{className:"text-xs w-50px",children:"\u5916\u8C8C"}),t(F,{style:{"--star-size":"10px"},readOnly:!0,value:(ie=(ne=(le=e==null?void 0:e.data)==null?void 0:le.evaluate)==null?void 0:ne.client)==null?void 0:ie.appearance})]}),r("div",{className:"flex items-center",children:[t("p",{className:"text-xs w-50px py-1",children:"\u670D\u52A1"}),t(F,{style:{"--star-size":"10px"},readOnly:!0,value:(ce=(de=(se=e==null?void 0:e.data)==null?void 0:se.evaluate)==null?void 0:de.client)==null?void 0:ce.server})]}),r("div",{className:"flex items-center",children:[t("p",{className:"text-xs w-50px",children:"\u6027\u4EF7\u6BD4"}),t(F,{style:{"--star-size":"10px"},readOnly:!0,value:(me=(oe=(ue=e==null?void 0:e.data)==null?void 0:ue.evaluate)==null?void 0:oe.client)==null?void 0:me.cost})]})]}),!k((fe=(pe=e==null?void 0:e.data)==null?void 0:pe.evaluate)==null?void 0:fe.client)&&r("div",{className:"flex flex-col",children:[t("p",{className:"text-sm text-color-[#000] pb-1",children:"\u8BC4\u8BBA"}),t("p",{className:"text-xs text-color-[#000]",children:(ye=(he=(xe=e==null?void 0:e.data)==null?void 0:xe.evaluate)==null?void 0:he.client)==null?void 0:ye.evaluate})]})]}),r("div",{className:"flex flex-col",children:[t("p",{className:"font-600 pt-5 pb-3",children:"\u5458\u5DE5\u8BC4\u5206"}),r("div",{className:"flex items-center",children:[t(F,{style:{"--star-size":"14px"},readOnly:!0,value:(we=(ve=(Ne=e==null?void 0:e.data)==null?void 0:Ne.evaluate)==null?void 0:ve.staff)==null?void 0:we.score}),k((ke=(Fe=e==null?void 0:e.data)==null?void 0:Fe.evaluate)==null?void 0:ke.staff)?t("p",{className:"text-xs pl-2 text-color-[#000]",children:"\u6682\u672A\u8BC4\u5206"}):r("p",{className:"text-xs pl-2 text-color-[#000]",children:["\u7EFC\u5408\u8BC4\u5206\uFF1A",(_e=(Ce=(Ae=e==null?void 0:e.data)==null?void 0:Ae.evaluate)==null?void 0:Ce.staff)==null?void 0:_e.score]})]})]})]})]})]})})}),r("div",{className:"flex flex-col items-center justify-center w-full h-100px border border-solid border-r-0 border-l-0 border-b-0 border-color-[#e7eaea]",children:[r("p",{className:"text-sm font-600",children:["\u603B\u4EF7\uFF1A$",e.data.total_amount,"(",e.data.duration/60,"hr)"]}),$e()]})]})]}),t(yt,{open:ze,onCancel:()=>{p(!1)},onOk:()=>{Ie.validateFields().then(a=>{qe(a)})},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:t(ge,{layout:"vertical",form:Ie,children:$==="earnest"?r(N,{children:[t(ge.Item,{name:"earnest",label:"\u4EF7\u683C",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:t(ht,{addonBefore:"$",className:`${x.PcearnestInput}`,style:{width:180},placeholder:"\u8BF7\u8F93\u5165"})}),t(ge.Item,{className:"ml-1",name:"information_id",label:"\u652F\u4ED8\u65B9\u5F0F",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:t(Nt,{style:{width:180},options:Le})})]}):t(N,{children:t(ge.Item,{name:"address",label:"\u5730\u5740",rules:[{required:!0,message:"\u6B64\u9879\u662F\u5FC5\u586B\u9879"}],children:t(Ze,{})})})})})]})}_.setApiKey(Ke);_.setLanguage("en");_.setRegion("es");_.setLocationType("ROOFTOP");function Sr(){var V,M,L,Y,H,z,R,q,J,K,G,W,U,Q,X,Z,D,b,ee,te,re,ae,le,ne,ie,se,de,ce,ue,oe,me,pe,fe,xe,he,ye,Ne,ve,we,Fe,ke,Ae,Ce,_e;const i=Ge(),v=We(),f=(V=v==null?void 0:v.state)==null?void 0:V.id,[Ie]=Ee.useForm();ot(document.querySelector("body"));const{data:e,loading:Ve,refresh:B}=C(S.getSubscribeDetail,{defaultParams:[{id:Number(f)}]}),{runAsync:Me}=C(S.editOrder,{manual:!0});C(()=>De.getInformationList({type:3}),{onSuccess(a){Ye(a==null?void 0:a.data)}});const{run:O}=C(a=>S.editOrder(a),{manual:!0,onSuccess(a){B(),A(!1)}}),[Le,Ye]=h.exports.useState([]),[je,He]=h.exports.useState(0),[ze,p]=h.exports.useState(!1),[$,A]=h.exports.useState(!1),[m,Se]=h.exports.useState("");h.exports.useState(""),h.exports.useEffect(()=>{e&&e.data&&He(e.data.status)},[e]);const u=async(a,l,n)=>{(await Me({source:a,params:JSON.stringify(l),id:f})).status===200&&(B(),n&&n())},Re=()=>{var a,l;i("/manage/customer/info",{state:{id:(a=e==null?void 0:e.data)==null?void 0:a.client_id,from:"calendarView",source:(l=e==null?void 0:e.data)==null?void 0:l.source}})},w=()=>{i("/calendar/pay",{state:{payInfo:e==null?void 0:e.data}})},qe=(a,l)=>{l.current&&l.current.open()},Oe=()=>{Se("earnest"),A(!0)},T=()=>{Se("address"),A(!0)},Je=a=>{m==="earnest"?O({id:f,source:2,params:JSON.stringify({information_id:a.information_id[0],earnest:a.earnest})}):m==="address"&&O({id:f,source:4,params:JSON.stringify({address:a.address})})},$e=()=>{var l;return o(((l=e==null?void 0:e.data)==null?void 0:l.start_time)*1e3).add(-15,"minutes").isBefore(o())},P=()=>{var l,n;return o(((l=e==null?void 0:e.data)==null?void 0:l.start_time)*1e3).add((n=e==null?void 0:e.data)==null?void 0:n.duration,"minutes").isBefore(o())},Te=()=>{const{status:a,source:l,server_type:n,push_house:d,staff_evaluate:Be}=e.data;return a===0&&l===2&&n===1?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{u(1,{},()=>{i("/calendar")})},children:"\u62D2\u7EDD\u63A5\u5355"}),t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:()=>{u(7,{})},children:"\u63A5\u53D7\u8BA2\u5355"})]}):a===0&&l===1&&n===1?t(N,{}):a===0&&l===1&&n===2?t(N,{}):a===0&&l===2&&n===2?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{u(1,{},()=>{i("/calendar")})},children:"\u62D2\u7EDD\u63A5\u5355"}),t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:()=>{u(7,{})},children:"\u63A5\u53D7\u8BA2\u5355"})]}):a===1&&n===1&&l===2?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{u(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:()=>{p(!0)},children:r("div",{className:"flex justify-center items-center",children:[t("span",{children:"\u66F4\u591A"}),t(y,{name:"caret-down",className:"w-[9px] h-[6px] fill-[#FFF] ml-1"})]})})]}):a===1&&n===1&&l===1?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{p(!0)},children:r("div",{className:"flex justify-center items-center",children:[t("span",{children:"\u66F4\u591A"}),t(y,{name:"caret-down",className:"w-[9px] h-[6px] ml-1"})]})}),t(s,{className:"w-[35%] ml-4 h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:w,children:"\u7ED3\u4ED8"})]}):a===1&&n===2&&l===2&&!$e()?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{u(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:()=>{p(!0)},children:r("div",{className:"flex justify-center items-center",children:[t("span",{children:"\u66F4\u591A"}),t(y,{name:"caret-down",className:"w-[9px] h-[6px] fill-[#FFF] ml-1"})]})})]}):a===1&&n===2&&l===2&&$e()?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{u(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:()=>{u(5,{})},children:"\u5458\u5DE5\u5DF2\u5230\u8FBE"})]}):a===1&&n===2&&l===1?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{p(!0)},children:r("div",{className:"flex justify-center items-center",children:[t("span",{children:"\u66F4\u591A"}),t(y,{name:"caret-down",className:"w-[9px] h-[6px] ml-1"})]})}),t(s,{className:"w-[35%] ml-4 h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:w,children:"\u7ED3\u4ED8"})]}):a===4&&n===1&&l===2&&!P()&&d!==1?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{u(9,{})},children:"\u53D6\u6D88\u8BA2\u5355"}),t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:()=>{u(8,{})},children:"\u53D1\u9001\u623F\u95F4\u53F7"})]}):a===4&&n===1&&l===2&&P()&&d!==1?t("div",{className:"fixed-b-btn",children:t(s,{className:"w-[90%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:w,children:"\u7ED3\u4ED8"})}):a===4&&n===1&&l===2&&d===1?t("div",{className:"fixed-b-btn",children:t(s,{className:"w-[90%] h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:w,children:"\u7ED3\u4ED8"})}):a===4&&n===1&&l===1?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{p(!0)},children:r("div",{className:"flex justify-center items-center",children:[t("span",{children:"\u66F4\u591A"}),t(y,{name:"caret-down",className:"w-[9px] h-[6px] ml-1"})]})}),t(s,{className:"w-[35%] ml-4 h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:w,children:"\u7ED3\u4ED8"})]}):a===4&&n===2&&l===2?t("div",{className:"fixed-b-btn",children:t(s,{className:"w-[90%] ml-4 h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:w,children:"\u7ED3\u4ED8"})}):a===4&&n===2&&l===1?r("div",{className:"fixed-b-btn",children:[t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl mr-4",block:!0,onClick:()=>{p(!0)},children:r("div",{className:"flex justify-center items-center",children:[t("span",{children:"\u66F4\u591A"}),t(y,{name:"caret-down",className:"w-[9px] h-[6px] ml-1"})]})}),t(s,{className:"w-[35%] ml-4 h-[2.75rem] rounded-3xl",block:!0,color:"primary",onClick:w,children:"\u7ED3\u4ED8"})]}):[2,3,6,7].includes(a)?t(N,{}):a==5&&Be===0&&l!==1?t("div",{className:"fixed-b-btn",children:t(Qe,{name:e.data.client_name,id:e.data.id,width:"90%",callback:B})}):t(N,{})};return Ve||!e.data?t(Xe,{loading:!0}):r(N,{children:[r("div",{className:`${x.CalendarView} pt-[48px] pb-[90px] sm:hidden`,children:[t(mt,{renderLeft:!1}),r("div",{className:"flex flex-col px-10 py-12",children:[t("span",{className:"text-2xl font-600",children:o(((M=e==null?void 0:e.data)==null?void 0:M.start_time)*1e3).format("YYYY\u5E74MM\u6708DD\u65E5")}),r("span",{className:"text-base text-color-[#9A9A9A]",children:[Pe(((L=e==null?void 0:e.data)==null?void 0:L.start_time)*1e3),"\xA0",o(((Y=e==null?void 0:e.data)==null?void 0:Y.start_time)*1e3).format("HH:mm")]}),r("div",{className:`${x.BorderedViewItem} flex flex-col mt-12`,children:[t("span",{className:"text-base font-600",children:e.data.online_name}),r("span",{className:"text-xs",children:[e.data.server_type===1?"\u5802\u98DF":"\u5916\u5356"," \uFF0C\u4E0E ",e.data.staff_name," ",e.data.duration,"\u5206\u949F\u7684\u9884\u7EA6"]})]}),r("div",{className:`${x.BorderedViewItem} flex flex-col `,children:[r("div",{className:"flex justify-between",children:[r("div",{className:"text-xs",children:[t("span",{className:"font-600",children:"\u57FA\u7840\u670D\u52A1\uFF1A"}),t("span",{children:e.data.basics_server})]}),r("span",{children:["$",e.data.basics_price]})]}),e.data.extra_ids.length>0?r("div",{className:"flex justify-between",children:[r("div",{className:"text-xs",children:[t("span",{className:"font-600",children:"\u989D\u5916\u670D\u52A1\uFF1A"}),t("span",{children:e.data.extra_server})]}),r("span",{children:["$",e.data.extra_price]})]}):null,r("div",{className:"flex justify-between",children:[t("div",{className:"text-xs",children:r("span",{className:"font-600 flex items-center",children:["\u5B9A\u91D1",((H=e==null?void 0:e.data)==null?void 0:H.source)===1&&t(y,{onClick:Oe,name:"edit",className:"w-[20px] h-16px"})]})}),r("span",{children:["$",e.data.earnest]})]})]}),r("div",{className:`${x.BorderedViewItem} flex flex-col pb-3`,children:[r("div",{className:"flex justify-between text-lg text-color-[#2A4948] font-600 mb-1",children:[r("span",{children:[e.data.duration/60,"hr"]}),r("span",{children:["$",e.data.total_amount]})]}),r("span",{className:"text-xs text-color-[#B7B7B7] mb-6",children:["\u8BA2\u5355\u53F7#",e.data.order_no," ",o(((z=e==null?void 0:e.data)==null?void 0:z.start_time)*1e3).format("YYYY\u5E74MM\u6708DD\u65E5")," ",Pe(((R=e==null?void 0:e.data)==null?void 0:R.start_time)*1e3),"\xA0",o(((q=e==null?void 0:e.data)==null?void 0:q.start_time)*1e3).format("HH:mm")]}),r("div",{className:"flex flex-wrap items-center text-xs",children:[t("span",{className:"text-color-[#464646] font-600",children:"\u5730\u5740\uFF1A"}),t("span",{className:"text-color-[#858585]",children:e.data.address}),t(y,{name:"edit",className:"w-[16px] h-[16px] ml-1 fill-[#2A4948]",onClick:T})]}),r("div",{className:"flex flex-wrap items-center text-xs",children:[t("span",{className:"text-color-[#464646] font-600",children:"\u5907\u6CE8\uFF1A"}),t("span",{className:"text-color-[#858585]",children:e.data.remark})]})]}),e.data.client_name&&r("div",{className:`${x.BorderedViewItem} flex items-center justify-between mt-4`,onClick:Re,children:[r("div",{className:"flex items-center",children:[t("div",{className:`${x.Avatar} flex items-center justify-center`,children:e.data.client_head?t("img",{src:e.data.client_head}):t("div",{children:e.data.client_name[0].toUpperCase()})}),r("div",{className:"flex flex-col ml-4",children:[t("span",{className:"text-base font-600",children:e.data.client_name}),t("span",{className:"text-xs text-color-[#999]",children:e.data.client_email})]})]}),t(y,{name:"caret-right",className:"w-[6px] h-[9px]"})]}),!k((J=e==null?void 0:e.data)==null?void 0:J.evaluate)&&((K=e==null?void 0:e.data)==null?void 0:K.source)!==1&&r("div",{className:"flex flex-col pt-10",children:[r("div",{className:"flex flex-col",children:[t("p",{className:"font-600 pb-3",children:"\u5BA2\u6237\u8BC4\u4EF7"}),r("div",{className:"flex items-center",children:[t(F,{style:{"--star-size":"14px"},readOnly:!0,value:(U=(W=(G=e==null?void 0:e.data)==null?void 0:G.evaluate)==null?void 0:W.client)==null?void 0:U.score}),k((X=(Q=e==null?void 0:e.data)==null?void 0:Q.evaluate)==null?void 0:X.client)?t("p",{className:"text-xs pl-2 text-color-[#000]",children:"\u6682\u672A\u8BC4\u5206"}):r("p",{className:"text-xs pl-2 text-color-[#000]",children:["\u7EFC\u5408\u8BC4\u5206\uFF1A",(b=(D=(Z=e==null?void 0:e.data)==null?void 0:Z.evaluate)==null?void 0:D.client)==null?void 0:b.score]})]}),!k((te=(ee=e==null?void 0:e.data)==null?void 0:ee.evaluate)==null?void 0:te.client)&&r("div",{className:"flex flex-col py-4",children:[t("p",{className:"text-sm text-color-[#000] pb-1",children:"\u8BC4\u5206\u6807\u51C6"}),r("div",{className:"flex items-center",children:[t("p",{className:"text-xs w-50px",children:"\u5916\u8C8C"}),t(F,{style:{"--star-size":"10px"},readOnly:!0,value:(le=(ae=(re=e==null?void 0:e.data)==null?void 0:re.evaluate)==null?void 0:ae.client)==null?void 0:le.appearance})]}),r("div",{className:"flex items-center",children:[t("p",{className:"text-xs w-50px py-1",children:"\u670D\u52A1"}),t(F,{style:{"--star-size":"10px"},readOnly:!0,value:(se=(ie=(ne=e==null?void 0:e.data)==null?void 0:ne.evaluate)==null?void 0:ie.client)==null?void 0:se.server})]}),r("div",{className:"flex items-center",children:[t("p",{className:"text-xs w-50px",children:"\u6027\u4EF7\u6BD4"}),t(F,{style:{"--star-size":"10px"},readOnly:!0,value:(ue=(ce=(de=e==null?void 0:e.data)==null?void 0:de.evaluate)==null?void 0:ce.client)==null?void 0:ue.cost})]})]}),!k((me=(oe=e==null?void 0:e.data)==null?void 0:oe.evaluate)==null?void 0:me.client)&&r("div",{className:"flex flex-col",children:[t("p",{className:"text-sm text-color-[#000] pb-1",children:"\u8BC4\u8BBA"}),t("p",{className:"text-xs text-color-[#000]",children:(xe=(fe=(pe=e==null?void 0:e.data)==null?void 0:pe.evaluate)==null?void 0:fe.client)==null?void 0:xe.evaluate})]})]}),r("div",{className:"flex flex-col",children:[t("p",{className:"font-600 pt-5 pb-3",children:"\u5458\u5DE5\u8BC4\u5206"}),r("div",{className:"flex items-center",children:[t(F,{style:{"--star-size":"14px"},readOnly:!0,value:(Ne=(ye=(he=e==null?void 0:e.data)==null?void 0:he.evaluate)==null?void 0:ye.staff)==null?void 0:Ne.score}),k((we=(ve=e==null?void 0:e.data)==null?void 0:ve.evaluate)==null?void 0:we.staff)?t("p",{className:"text-xs pl-2 text-color-[#000]",children:"\u6682\u672A\u8BC4\u5206"}):r("p",{className:"text-xs pl-2 text-color-[#000]",children:["\u7EFC\u5408\u8BC4\u5206\uFF1A",(Ae=(ke=(Fe=e==null?void 0:e.data)==null?void 0:Fe.evaluate)==null?void 0:ke.staff)==null?void 0:Ae.score]})]})]})]})]}),Te(),t(pt,{actions:je===0||e.data.source===1?[{text:"\u7F16\u8F91\u9884\u7EA6",key:"edit",onClick:()=>{i(`/calendar/edit/order/${f}`,{state:{customerId:e.data.client_id}}),p(!1)}},{text:"\u91CD\u65B0\u6392\u671F",key:"rearrange",onClick:()=>{i(`/calendar/edit/order/${f}`,{state:{customerId:e.data.client_id}}),p(!1)}},{text:"\u53D6\u6D88\u9884\u7EA6",key:"cancel",danger:!0,onClick:()=>{u(9,{},()=>{p(!1),i("/calendar")})}}]:je===1&&e.data.server_type===2&&e.data.source===2||je===1&&e.data.server_type===1&&e.data.source===2?[{text:"\u66F4\u6539\u65F6\u95F4",key:"edit_time",async onClick(){const a=await Ue.prompt({precision:"minute"});a&&u(3,{start_time:o(a).unix()},()=>{p(!1),i("/calendar")})}},{text:"\u66F4\u6539\u5730\u5740",key:"edit_address",disabled:!(((Ce=e==null?void 0:e.data)==null?void 0:Ce.server_type)===1&&((_e=e==null?void 0:e.data)==null?void 0:_e.source)===2),onClick(){T()}}]:[],visible:ze,setVisible:p}),t(dt,{visible:$,onMaskClick:()=>{A(!1)},children:t("div",{className:"p-6",children:r(Ee,{style:{"--border-bottom":"none","--border-top":"none","--border-inner":"none"},requiredMarkStyle:"none",onFinish:Je,form:Ie,footer:null,children:[t("div",{className:`${xt.FormItemWrapper} flex items-center`,children:m==="earnest"?r("div",{className:"flex mr-2",children:[t("div",{className:"flex items-center mr-1",children:t(Ee.Item,{name:"earnest",label:"\u4EF7\u683C",rules:[{required:!0}],children:t(ct,{className:`py-2 ${x.earnestInput}`,style:{border:"1px solid #ced6d5",borderRadius:20,paddingLeft:12},placeholder:"\u8BF7\u8F93\u5165"})})}),t(Ee.Item,{className:"ml-1",name:"information_id",label:"\u652F\u4ED8\u65B9\u5F0F",trigger:"onConfirm",rules:[{required:!0}],onClick:qe,arrow:null,children:t(ut,{className:"",columns:[Le],children:a=>t(ft,{style:{minHeight:36,border:"1px solid #ced6d5",borderRadius:20,minWidth:130,padding:"0 10px"},val:a,textType:"normal",innerHeight:"18px"})})})]}):m==="address"?t("div",{className:"relative w-full",children:t(Ee.Item,{name:"address",label:"\u5730\u5740",rules:[{required:!0}],children:t(Ze,{})})}):null}),r("div",{className:"flex justify-center items-center pt-4",children:[t(s,{onClick:()=>{A(!1)},className:"w-[35%] h-[2.75rem] rounded-3xl mr-1",block:!0,children:"\u53D6\u6D88"}),t(s,{className:"w-[35%] h-[2.75rem] rounded-3xl ml-1",block:!0,type:"submit",color:"primary",children:"\u786E\u5B9A"})]})]})})})]}),t("div",{className:"<sm:hidden",children:t(Mt,{})})]})}export{Sr as default};
