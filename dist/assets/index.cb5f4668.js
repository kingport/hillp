import{s as w,u as V,k as G,b as e,j as i,$ as q,S as B,a0 as J,r as u,a as K,F as O,B as k,T as F,de as Q}from"./index.5670e6e0.js";import{F as d}from"./index.11c9b67d.js";import{I as N}from"./index.66fe089c.js";import{P as W}from"./index.77a6b2f7.js";import{D as X}from"./dropdown.706ec38f.js";import{H as Z}from"./index.04556cd2.js";import{s as y}from"./index.module.f94ed99e.js";import{H as z}from"./index.9fe94518.js";import{u as I}from"./index.5733fb44.js";import{E as ee}from"./index.1c39e7a0.js";import{P as A}from"./personal.dd90e075.js";import{U as te}from"./upload.3b886abe.js";import{S as ae}from"./Skeleton.c599669d.js";/* empty css                    *//* empty css                 */import"./is-node-with-content.f661b98b.js";import"./interopRequireDefault.fc5525a1.js";import"./dev-log.6e115cc9.js";import"./index.31244c45.js";import"./index.cb878f88.js";import"./convert-px.daab3cc2.js";import"./CloseCircleFill.55d4b485.js";import"./bound.bddb6539.js";import"./index.c6660251.js";import"./use-gesture-react.esm.346ddc85.js";import"./rubberband.c88fa690.js";import"./PurePanel.2a417db7.js";import"./index.42a6e0fb.js";import"./index.92e459fd.js";import"./collapse.e34cf270.js";import"./useFlexGapSupport.172cfcf4.js";const le=b=>{var r,g,h,o,p;const l=w.getState().global.userInfo,m=V(),{data:t}=G(()=>A.assetList({}));return e("div",{className:"flex flex-col w-600px h-full justify-center <sm:hidden",children:i(ae,{loading:!l,active:!0,children:[i("div",{className:"flex w-full justify-between",children:[i("div",{className:"flex items-center",children:[e("div",{className:"border border-solid flex justify-center items-center border-color-[#cee2ee] border-width-1px w-120px h-120px rounded-full",children:e(q,{name:l==null?void 0:l.nickname,headurl:l==null?void 0:l.head,sx:{width:106,height:106}})}),i("div",{className:"flex flex-col pl-8",children:[e("p",{className:"font-600 text-lg",children:l==null?void 0:l.nickname}),i("span",{className:"text-color-[#ACACAC] pt-1 pb-1 text-xs",children:["UID ",l==null?void 0:l.user_id]})]})]}),i("div",{onClick:()=>{(l==null?void 0:l.user_type)===2&&m("/manage/base/info"),(l==null?void 0:l.user_type)===1&&m("/manage/base/info")},className:"flex cursor-pointer text-sm",children:[e(B,{name:"edit",className:"w-[18px] mr-2 h-[20px] cursor-pointer"}),e("div",{className:"h-20px",children:"\u7F16\u8F91\u8D44\u6599"})]})]}),i("div",{className:"flex justify-between pt-12",children:[e("div",{className:"flex flex-col w-[48%]",children:i("div",{className:"flex flex-col rounded-2xl bg-[#f6f8f8] py-4 px-7",children:[i("div",{className:"flex text-xs items-center",children:[e("span",{className:"font-600 text-color-[#3F3F3F]",children:"\u4E2A\u4EBA\u90AE\u7BB1\uFF1A"}),e("span",{className:"underline cursor-pointer text-color-[#3F3F3F]",children:l==null?void 0:l.email})]}),i("div",{className:"flex text-xs items-center pt-1",children:[e("span",{className:"font-600 text-color-[#3F3F3F]",children:"\u4E2A\u4EBA\u624B\u673A\uFF1A"}),e("span",{className:"text-color-[#3F3F3F]",children:l==null?void 0:l.phone})]})]})}),e("div",{className:"flex w-[48%] relative flex-col rounded-2xl bg-[#f6f8f8] py-4 px-7 text-color-[#3F3F3F] text-xs",children:i("div",{className:"leading-6",children:[((r=t==null?void 0:t.data)==null?void 0:r.status)===2&&e("span",{className:"underline-current underline cursor-pointer",onClick:()=>{m("/personal/auth/online",{state:{type:"wallet"}})},children:"\u672A\u5F00\u901A\u5347\u7EA7\u8D26\u6237\uFF0C\u8BF7\u5347\u7EA7"}),((g=t==null?void 0:t.data)==null?void 0:g.status)!==2&&i("div",{className:"flex items-center",children:[i("div",{className:"flex flex-col pr-4 text-xs text-color-[#000]",children:[e("p",{children:"\u5957\u9910"}),e("p",{className:"text-color-[#666]",children:((h=t==null?void 0:t.data)==null?void 0:h.setmeal)||"\u65E0"})]}),i("div",{className:"flex flex-col text-xs text-color-[#000]",children:[e("p",{children:"\u6709\u6548\u671F\u81F3"}),e("p",{className:"text-color-[#666]",children:(o=t==null?void 0:t.data)!=null&&o.promotion_endtime?J(((p=t==null?void 0:t.data)==null?void 0:p.promotion_endtime)*1e3).format("YYYY-MM-DD"):"\u65E0"})]})]})]})})]})]})})};function qe(){const b=V(),l=I(document.querySelector("body")),m=u.exports.useRef(null),t=w.getState().global.userInfo,{area:r}=w.getState().global.areaRegion,[g,h]=u.exports.useState(!1),[o,p]=u.exports.useState([r[0].label]),[x]=d.useForm(),[U,v]=u.exports.useState(!1),[c,E]=u.exports.useState({file_path:"",file_url:""}),[_,H]=u.exports.useState(!1),M=a=>{H(a!==t.email)},[S,R]=u.exports.useState(!1),Y=a=>{R(a!==t.phone)},$=async()=>{await x.validateFields().then(async a=>{var n;if(o&&(a.area=(n=r.find(f=>f.label===o[0]))==null?void 0:n.value),_&&!await P(2,a.email,a.email_code)||S&&!await P(1,a.phone,a.phone_code,a.area))return;((c==null?void 0:c.file_path)||(t==null?void 0:t.head))&&(a.head=(c==null?void 0:c.file_path)||t.head);const s=await A.editBaseUser({...a});s.status===200&&(F.show(s.msg),w.dispatch(Q),b("/personal"))})},D=async(a,s,n="")=>{let f={source:1,type:a,username:s,area_code:n};const C=await A.getVerifyCode(f);C.status===200?F.show("\u53D1\u9001\u6210\u529F"):F.show(C.msg)},P=async(a,s,n,f="")=>{let C={source:1,type:a,username:s,code:n,area_code:f};const j=await A.checkVerifyCode(C);return j.status!==200?(F.show(j.msg),!1):!0};K(()=>{var a;x.setFieldsValue({nickname:t.nickname,email:t.email,phone:t.phone}),p([(a=r.find(s=>s.value===t.area_id*1))==null?void 0:a.label]),E({file_url:t.head})});const T=async a=>{const s=[...a.target.files];if(s.length){const n=await te.uploadFile(s);(n==null?void 0:n.status)===200&&(F.show(n.data.msg),E(n.data.data))}},L=a=>{a!=null&&a.key&&p([r.find(s=>Number(s.value)===Number(a==null?void 0:a.key)).label])};return i(O,{children:[i("div",{className:`${y.AddEmployeeForm} pt-[48px] pb-[90px] bg-[#fff] sm:hidden`,children:[e(Z,{renderRight:!1,title:(t==null?void 0:t.user_type)===2?"\u5546\u5BB6\u4FE1\u606F":"\u4E2A\u4EBA\u4FE1\u606F",border:!0}),i("div",{className:"flex flex-col px-10 py-12",children:[i(d,{form:x,requiredMarkStyle:"none",footer:null,children:[i("div",{className:"flex items-center",children:[e(q,{name:t==null?void 0:t.nickname,headurl:c==null?void 0:c.file_url}),e(k,{onClick:async()=>{await m.current.click()},className:"bg-[#f3f3f3] border-0 ml-4",shape:"rounded",children:"\u4E0A\u4F20\u5934\u50CF"}),e("input",{id:"file",type:"file",ref:m,accept:".jpg,.jpeg,.png",hidden:!0,onChange:a=>T(a)})]}),e(d.Item,{name:"nickname",label:(t==null?void 0:t.user_type)===1?"\u4E2A\u4EBA\u6635\u79F0*":"\u5546\u5BB6\u540D\u79F0* ",rules:[{required:!0}],children:e(N,{placeholder:"\u6635\u79F0"})}),e(d.Item,{name:"email",label:"\u90AE\u7BB1*",rules:[{required:!0}],children:e(N,{placeholder:"\u90AE\u7BB1",onChange:M})}),_&&e(d.Item,{name:"email_code",label:"\u90AE\u7BB1\u9A8C\u8BC1\u7801",rules:[{required:!0}],extra:e("a",{className:"relative top-20px text-xs",onClick:()=>{D(2,x.getFieldValue("email"))},children:"\u83B7\u53D6\u9A8C\u8BC1\u7801"}),children:e(N,{})}),e(d.Item,{label:"\u624B\u673A*",children:i("div",{className:y.phone,children:[i("div",{onClick:()=>{(l==null?void 0:l.width)&&(l==null?void 0:l.width)<=640&&h(!0)},className:`${y.phoneCode} text-xs h-full pl-3 pr-2 flex items-center justify-center`,children:[e("p",{className:"min-w-30px text-center sm:hidden",children:o}),e(X,{menu:{items:r,onClick:L},className:"<sm:hidden min-w-40px text-center",children:e("a",{onClick:a=>a.preventDefault(),children:o})}),e(B,{name:"phone-bottom",className:"w-[5px] h-[3px]"})]}),e(W,{columns:[r],visible:g,onClose:()=>{h(!1)},value:o,onConfirm:a=>{p([r.find(s=>s.value===a[0]).label])}}),e(d.Item,{noStyle:!0,name:"phone",rules:[{required:!0}],children:e(N,{placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",className:y.input,onChange:Y})})]})}),S&&e(d.Item,{name:"phone_code",label:"\u624B\u673A\u9A8C\u8BC1\u7801",rules:[{required:!0}],extra:e("a",{className:"relative top-20px text-xs",onClick:()=>{D(1,x.getFieldValue("phone"),o[0])},children:"\u83B7\u53D6\u9A8C\u8BC1\u7801"}),children:e(N,{})}),i("div",{className:"fixed-b-btn flex",children:[e(k,{onClick:()=>v(!0),className:"w-[12%] flex items-center justify-center mr-4 h-[2.75rem] rounded-xl border-0 bg-[#F3F3F3]",block:!0,children:e(B,{name:"point",className:"w-[15px] h-[3px]"})}),e(k,{onClick:$,className:"w-[56%] h-[2.75rem] rounded-xl",block:!0,type:"submit",color:"primary",loading:"auto",loadingIcon:e(ee,{}),children:"\u4FDD\u5B58"})]})]}),e(z,{actions:[{text:"\u7F16\u8F91\u8BE6\u7EC6\u8D44\u6599",key:"editDetail",onClick:()=>{(t==null?void 0:t.user_type)===2&&b("/personal/information/merchant/edit"),(t==null?void 0:t.user_type)===1&&b("/manage/employee/info/edit/detail",{state:{onlineUser:"onlineUser",nickname:t==null?void 0:t.nickname}})}}],visible:U,setVisible:v})]})]}),e("div",{className:"<sm:hidden",children:e(le,{})})]})}export{qe as default};
